/*!
 * jQuery Cookie Plugin v1.3
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function(f,b,g){var a=/\+/g;function e(h){return h}function c(h){return decodeURIComponent(h.replace(a," "))}var d=f.cookie=function(p,o,u){if(o!==g){u=f.extend({},d.defaults,u);if(o===null){u.expires=-1}if(typeof u.expires==="number"){var q=u.expires,s=u.expires=new Date();s.setDate(s.getDate()+q)}o=d.json?JSON.stringify(o):String(o);return(b.cookie=[encodeURIComponent(p),"=",d.raw?o:encodeURIComponent(o),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join(""))}var h=d.raw?e:c;var r=b.cookie.split("; ");for(var n=0,k=r.length;n<k;n++){var m=r[n].split("=");if(h(m.shift())===p){var j=h(m.join("="));return d.json?JSON.parse(j):j}}return null};d.defaults={};f.removeCookie=function(i,h){if(f.cookie(i)!==null){f.cookie(i,null,h);return true}return false}})(jQuery,document);!function(c){var a=function(e,d){this.element=c(e);this.format=b.parseFormat(d.format||this.element.data("date-format")||"mm/dd/yyyy");this.picker=c(b.template).appendTo("body").on({click:c.proxy(this.click,this)});this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on"):false;if(this.isInput){this.element.on({focus:c.proxy(this.show,this),keyup:c.proxy(this.update,this)})}else{if(this.component){this.component.on("click",c.proxy(this.show,this))}else{this.element.on("click",c.proxy(this.show,this))}}this.minViewMode=d.minViewMode||this.element.data("date-minviewmode")||0;if(typeof this.minViewMode==="string"){switch(this.minViewMode){case"months":this.minViewMode=1;break;case"years":this.minViewMode=2;break;default:this.minViewMode=0;break}}this.viewMode=d.viewMode||this.element.data("date-viewmode")||0;if(typeof this.viewMode==="string"){switch(this.viewMode){case"months":this.viewMode=1;break;case"years":this.viewMode=2;break;default:this.viewMode=0;break}}this.startViewMode=this.viewMode;this.weekStart=d.weekStart||this.element.data("date-weekstart")||0;this.weekEnd=this.weekStart===0?6:this.weekStart-1;this.onRender=d.onRender;this.fillDow();this.fillMonths();this.update();this.showMode()};a.prototype={constructor:a,show:function(f){this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();c(window).on("resize",c.proxy(this.place,this));if(f){f.stopPropagation();f.preventDefault()}if(!this.isInput){}var d=this;c(document).on("mousedown",function(e){if(c(e.target).closest(".datepicker").length==0){d.hide()}});this.element.trigger({type:"show",date:this.date})},hide:function(){this.picker.hide();c(window).off("resize",this.place);this.viewMode=this.startViewMode;this.showMode();if(!this.isInput){c(document).off("mousedown",this.hide)}this.element.trigger({type:"hide",date:this.date})},set:function(){var d=b.formatDate(this.date,this.format);if(!this.isInput){if(this.component){this.element.find("input").prop("value",d)}this.element.data("date",d)}else{this.element.prop("value",d)}},setValue:function(d){if(typeof d==="string"){this.date=b.parseDate(d,this.format)}else{this.date=new Date(d)}this.set();this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill()},place:function(){var d=this.component?this.component.offset():this.element.offset();this.picker.css({top:d.top+this.height,left:d.left})},update:function(d){this.date=b.parseDate(typeof d==="string"?d:(this.isInput?this.element.prop("value"):this.element.data("date")),this.format);this.viewDate=new Date(this.date.getFullYear(),this.date.getMonth(),1,0,0,0,0);this.fill()},fillDow:function(){var d=this.weekStart;var e="<tr>";while(d<this.weekStart+7){e+='<th class="dow">'+b.dates.daysMin[(d++)%7]+"</th>"}e+="</tr>";this.picker.find(".datepicker-days thead").append(e)},fillMonths:function(){var e="";var d=0;while(d<12){e+='<span class="month">'+b.dates.monthsShort[d++]+"</span>"}this.picker.find(".datepicker-months td").append(e)},fill:function(){var r=new Date(this.viewDate),s=r.getFullYear(),q=r.getMonth(),g=this.date.valueOf();this.picker.find(".datepicker-days th:eq(1)").text(b.dates.months[q]+" "+s);var k=new Date(s,q-1,28,0,0,0,0),t=b.getDaysInMonth(k.getFullYear(),k.getMonth());k.setDate(t);k.setDate(t-(k.getDay()-this.weekStart+7)%7);var n=new Date(k);n.setDate(n.getDate()+42);n=n.valueOf();var m=[];var j,p,e;while(k.valueOf()<n){if(k.getDay()===this.weekStart){m.push("<tr>")}j=this.onRender(k);p=k.getFullYear();e=k.getMonth();if((e<q&&p===s)||p<s){j+=" old"}else{if((e>q&&p===s)||p>s){j+=" new"}}if(k.valueOf()===g){j+=" active"}m.push('<td class="day '+j+'">'+k.getDate()+"</td>");if(k.getDay()===this.weekEnd){m.push("</tr>")}k.setDate(k.getDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(m.join(""));var o=this.date.getFullYear();var f=this.picker.find(".datepicker-months").find("th:eq(1)").text(s).end().find("span").removeClass("active");if(o===s){f.eq(this.date.getMonth()).addClass("active")}m="";s=parseInt(s/10,10)*10;var h=this.picker.find(".datepicker-years").find("th:eq(1)").text(s+"-"+(s+9)).end().find("td");s-=1;for(var l=-1;l<11;l++){m+='<span class="year'+(l===-1||l===10?" old":"")+(o===s?" active":"")+'">'+s+"</span>";s+=1}h.html(m)},click:function(i){i.stopPropagation();i.preventDefault();var h=c(i.target).closest("span, td, th");if(h.length===1){switch(h[0].nodeName.toLowerCase()){case"th":switch(h[0].className){case"switch":this.showMode(1);break;case"prev":case"next":this.viewDate["set"+b.modes[this.viewMode].navFnc].call(this.viewDate,this.viewDate["get"+b.modes[this.viewMode].navFnc].call(this.viewDate)+b.modes[this.viewMode].navStep*(h[0].className==="prev"?-1:1));this.fill();this.set();break}break;case"span":if(h.is(".month")){var g=h.parent().find("span").index(h);this.viewDate.setMonth(g)}else{var f=parseInt(h.text(),10)||0;this.viewDate.setFullYear(f)}if(this.viewMode!==0){this.date=new Date(this.viewDate);this.element.trigger({type:"changeDate",date:this.date,viewMode:b.modes[this.viewMode].clsName})}this.showMode(-1);this.fill();this.set();break;case"td":if(h.is(".day")&&!h.is(".disabled")){var d=parseInt(h.text(),10)||1;var g=this.viewDate.getMonth();if(h.is(".old")){g-=1}else{if(h.is(".new")){g+=1}}var f=this.viewDate.getFullYear();this.date=new Date(f,g,d,0,0,0,0);this.viewDate=new Date(f,g,Math.min(28,d),0,0,0,0);this.fill();this.set();this.element.trigger({type:"changeDate",date:this.date,viewMode:b.modes[this.viewMode].clsName})}break}}},mousedown:function(d){d.stopPropagation();d.preventDefault()},showMode:function(d){if(d){this.viewMode=Math.max(this.minViewMode,Math.min(2,this.viewMode+d))}this.picker.find(">div").hide().filter(".datepicker-"+b.modes[this.viewMode].clsName).show()}};c.fn.datepicker=function(d,e){return this.each(function(){var h=c(this),g=h.data("datepicker"),f=typeof d==="object"&&d;if(!g){h.data("datepicker",(g=new a(this,c.extend({},c.fn.datepicker.defaults,f))))}if(typeof d==="string"){g[d](e)}})};c.fn.datepicker.defaults={onRender:function(d){return""}};c.fn.datepicker.Constructor=a;var b={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],dates:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},isLeapYear:function(d){return(((d%4===0)&&(d%100!==0))||(d%400===0))},getDaysInMonth:function(d,e){return[31,(b.isLeapYear(d)?29:28),31,30,31,30,31,31,30,31,30,31][e]},parseFormat:function(f){var e=f.match(/[.\/\-\s].*?/),d=f.split(/\W+/);if(!e||!d||d.length===0){throw new Error("Invalid date format.")}return{separator:e,parts:d}},parseDate:function(f,m){var g=f.split(m.separator),f=new Date(),e;f.setHours(0);f.setMinutes(0);f.setSeconds(0);f.setMilliseconds(0);if(g.length===m.parts.length){var k=f.getFullYear(),l=f.getDate(),j=f.getMonth();for(var h=0,d=m.parts.length;h<d;h++){e=parseInt(g[h],10)||1;switch(m.parts[h]){case"dd":case"d":l=e;f.setDate(e);break;case"mm":case"m":j=e-1;f.setMonth(e-1);break;case"yy":k=2000+e;f.setFullYear(2000+e);break;case"yyyy":k=e;f.setFullYear(e);break}}f=new Date(k,j,l,0,0,0)}return f},formatDate:function(d,g){var h={d:d.getDate(),m:d.getMonth()+1,yy:d.getFullYear().toString().substring(2),yyyy:d.getFullYear()};h.dd=(h.d<10?"0":"")+h.d;h.mm=(h.m<10?"0":"")+h.m;var d=[];for(var f=0,e=g.parts.length;f<e;f++){d.push(h[g.parts[f]])}return d.join(g.separator)},headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'};b.template='<div class="datepicker dropdown-menu"><div class="datepicker-days"><table class=" table-condensed">'+b.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+b.headTemplate+b.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+b.headTemplate+b.contTemplate+"</table></div></div>"}(window.jQuery);!function(b){var a=function(d,c){this.$element=b(d);this.options=b.extend({},b.fn.timepicker.defaults,c,this.$element.data());this.minuteStep=this.options.minuteStep||this.minuteStep;this.secondStep=this.options.secondStep||this.secondStep;this.showMeridian=this.options.showMeridian||this.showMeridian;this.showSeconds=this.options.showSeconds||this.showSeconds;this.showInputs=this.options.showInputs||this.showInputs;this.disableFocus=this.options.disableFocus||this.disableFocus;this.template=this.options.template||this.template;this.modalBackdrop=this.options.modalBackdrop||this.modalBackdrop;this.defaultTime=this.options.defaultTime||this.defaultTime;this.open=false;this.init()};a.prototype={constructor:a,init:function(){if(this.$element.parent().hasClass("input-append")){this.$element.parent(".input-append").find(".add-on").on("click",b.proxy(this.showWidget,this));this.$element.on({focus:b.proxy(this.highlightUnit,this),click:b.proxy(this.highlightUnit,this),keypress:b.proxy(this.elementKeypress,this),blur:b.proxy(this.blurElement,this)})}else{if(this.template){this.$element.on({focus:b.proxy(this.showWidget,this),click:b.proxy(this.showWidget,this),blur:b.proxy(this.blurElement,this)})}else{this.$element.on({focus:b.proxy(this.highlightUnit,this),click:b.proxy(this.highlightUnit,this),keypress:b.proxy(this.elementKeypress,this),blur:b.proxy(this.blurElement,this)})}}this.$widget=b(this.getTemplate()).appendTo("body");this.$widget.on("click",b.proxy(this.widgetClick,this));if(this.showInputs){this.$widget.find("input").on({click:function(){this.select()},keypress:b.proxy(this.widgetKeypress,this),change:b.proxy(this.updateFromWidgetInputs,this)})}this.setDefaultTime(this.defaultTime)},showWidget:function(c){c.stopPropagation();c.preventDefault();if(this.open){return}this.$element.trigger("show");if(this.disableFocus){this.$element.blur()}var d=b.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight});this.updateFromElementVal();b("html").trigger("click.timepicker.data-api").one("click.timepicker.data-api",b.proxy(this.hideWidget,this));if(this.template==="modal"){this.$widget.modal("show").on("hidden",b.proxy(this.hideWidget,this))}else{this.$widget.css({top:d.top+d.height,left:d.left});if(!this.open){this.$widget.addClass("open")}}this.open=true;this.$element.trigger("shown")},hideWidget:function(){this.$element.trigger("hide");if(this.template==="modal"){this.$widget.modal("hide")}else{this.$widget.removeClass("open")}this.open=false;this.$element.trigger("hidden")},widgetClick:function(d){d.stopPropagation();d.preventDefault();var c=b(d.target).closest("a").data("action");if(c){this[c]();this.update()}},widgetKeypress:function(d){var c=b(d.target).closest("input").attr("name");switch(d.keyCode){case 9:if(this.showMeridian){if(c=="meridian"){this.hideWidget()}}else{if(this.showSeconds){if(c=="second"){this.hideWidget()}}else{if(c=="minute"){this.hideWidget()}}}break;case 27:this.hideWidget();break;case 38:switch(c){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.update();break;case 40:switch(c){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.update();break}},elementKeypress:function(d){var c=this.$element.get(0);switch(d.keyCode){case 0:break;case 9:this.updateFromElementVal();if(this.showMeridian){if(this.highlightedUnit!="meridian"){d.preventDefault();this.highlightNextUnit()}}else{if(this.showSeconds){if(this.highlightedUnit!="second"){d.preventDefault();this.highlightNextUnit()}}else{if(this.highlightedUnit!="minute"){d.preventDefault();this.highlightNextUnit()}}}break;case 27:this.updateFromElementVal();break;case 37:this.updateFromElementVal();this.highlightPrevUnit();break;case 38:switch(this.highlightedUnit){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.updateElement();break;case 39:this.updateFromElementVal();this.highlightNextUnit();break;case 40:switch(this.highlightedUnit){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.updateElement();break}if(d.keyCode!==0&&d.keyCode!==8&&d.keyCode!==9&&d.keyCode!==46){d.preventDefault()}},setValues:function(e){if(this.showMeridian){var c=e.split(" ");var d=c[0].split(":");this.meridian=c[1]}else{var d=e.split(":")}this.hour=parseInt(d[0],10);this.minute=parseInt(d[1],10);this.second=parseInt(d[2],10);if(isNaN(this.hour)){this.hour=0}if(isNaN(this.minute)){this.minute=0}if(this.showMeridian){if(this.hour>12){this.hour=12}else{if(this.hour<1){this.hour=1}}if(this.meridian=="am"||this.meridian=="a"){this.meridian="AM"}else{if(this.meridian=="pm"||this.meridian=="p"){this.meridian="PM"}}if(this.meridian!="AM"&&this.meridian!="PM"){this.meridian="AM"}}else{if(this.hour>=24){this.hour=23}else{if(this.hour<0){this.hour=0}}}if(this.minute<0){this.minute=0}else{if(this.minute>=60){this.minute=59}}if(this.showSeconds){if(isNaN(this.second)){this.second=0}else{if(this.second<0){this.second=0}else{if(this.second>=60){this.second=59}}}}if(this.$element.val()!=""){this.updateElement()}this.updateWidget()},setMeridian:function(c){if(c=="a"||c=="am"||c=="AM"){this.meridian="AM"}else{if(c=="p"||c=="pm"||c=="PM"){this.meridian="PM"}else{this.updateWidget()}}this.updateElement()},setDefaultTime:function(e){if(e){if(e==="current"){var c=new Date();var d=c.getHours();var g=Math.floor(c.getMinutes()/this.minuteStep)*this.minuteStep;var h=Math.floor(c.getSeconds()/this.secondStep)*this.secondStep;var f="AM";if(this.showMeridian){if(d===0){d=12}else{if(d>=12){if(d>12){d=d-12}f="PM"}else{f="AM"}}}this.hour=d;this.minute=g;this.second=h;this.meridian=f}else{if(e==="value"){this.setValues(this.$element.val())}else{this.setValues(e)}}if(this.$element.val()!=""){this.updateElement()}this.updateWidget()}else{this.hour=0;this.minute=0;this.second=0}},formatTime:function(c,f,d,e){c=c<10?"0"+c:c;f=f<10?"0"+f:f;d=d<10?"0"+d:d;return c+":"+f+(this.showSeconds?":"+d:"")+(this.showMeridian?" "+e:"")},getTime:function(){return this.formatTime(this.hour,this.minute,this.second,this.meridian)},setTime:function(c){this.setValues(c);this.update()},update:function(){this.updateElement();this.updateWidget()},blurElement:function(){this.highlightedUnit=undefined;this.updateFromElementVal()},updateElement:function(){var c=this.getTime();this.$element.val(c).change();switch(this.highlightedUnit){case"hour":this.highlightHour();break;case"minute":this.highlightMinute();break;case"second":this.highlightSecond();break;case"meridian":this.highlightMeridian();break}},updateWidget:function(){if(this.showInputs){this.$widget.find("input.bootstrap-timepicker-hour").val(this.hour<10?"0"+this.hour:this.hour);this.$widget.find("input.bootstrap-timepicker-minute").val(this.minute<10?"0"+this.minute:this.minute);if(this.showSeconds){this.$widget.find("input.bootstrap-timepicker-second").val(this.second<10?"0"+this.second:this.second)}if(this.showMeridian){this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)}}else{this.$widget.find("span.bootstrap-timepicker-hour").text(this.hour);this.$widget.find("span.bootstrap-timepicker-minute").text(this.minute<10?"0"+this.minute:this.minute);if(this.showSeconds){this.$widget.find("span.bootstrap-timepicker-second").text(this.second<10?"0"+this.second:this.second)}if(this.showMeridian){this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian)}}},updateFromElementVal:function(d){var c=this.$element.val();if(c){this.setValues(c);this.updateWidget()}},updateFromWidgetInputs:function(){var c=b("input.bootstrap-timepicker-hour",this.$widget).val()+":"+b("input.bootstrap-timepicker-minute",this.$widget).val()+(this.showSeconds?":"+b("input.bootstrap-timepicker-second",this.$widget).val():"")+(this.showMeridian?" "+b("input.bootstrap-timepicker-meridian",this.$widget).val():"");this.setValues(c)},getCursorPosition:function(){var d=this.$element.get(0);if("selectionStart" in d){return d.selectionStart}else{if(document.selection){d.focus();var e=document.selection.createRange();var c=document.selection.createRange().text.length;e.moveStart("character",-d.value.length);return e.text.length-c}}},highlightUnit:function(){var c=this.$element.get(0);this.position=this.getCursorPosition();if(this.position>=0&&this.position<=2){this.highlightHour()}else{if(this.position>=3&&this.position<=5){this.highlightMinute()}else{if(this.position>=6&&this.position<=8){if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}}else{if(this.position>=9&&this.position<=11){this.highlightMeridian()}}}}},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}break;case"second":this.highlightMeridian();break;case"meridian":this.highlightHour();break}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMeridian();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}break}},highlightHour:function(){this.highlightedUnit="hour";this.$element.get(0).setSelectionRange(0,2)},highlightMinute:function(){this.highlightedUnit="minute";this.$element.get(0).setSelectionRange(3,5)},highlightSecond:function(){this.highlightedUnit="second";this.$element.get(0).setSelectionRange(6,8)},highlightMeridian:function(){this.highlightedUnit="meridian";if(this.showSeconds){this.$element.get(0).setSelectionRange(9,11)}else{this.$element.get(0).setSelectionRange(6,8)}},incrementHour:function(){if(this.showMeridian){if(this.hour===11){this.toggleMeridian()}else{if(this.hour===12){return this.hour=1}}}if(this.hour===23){return this.hour=0}this.hour=this.hour+1},decrementHour:function(){if(this.showMeridian){if(this.hour===1){return this.hour=12}else{if(this.hour===12){this.toggleMeridian()}}}if(this.hour===0){return this.hour=23}this.hour=this.hour-1},incrementMinute:function(){var c=this.minute+this.minuteStep-(this.minute%this.minuteStep);if(c>59){this.incrementHour();this.minute=c-60}else{this.minute=c}},decrementMinute:function(){var c=this.minute-this.minuteStep;if(c<0){this.decrementHour();this.minute=c+60}else{this.minute=c}},incrementSecond:function(){var c=this.second+this.secondStep-(this.second%this.secondStep);if(c>59){this.incrementMinute();this.second=c-60}else{this.second=c}},decrementSecond:function(){var c=this.second-this.secondStep;if(c<0){this.decrementMinute();this.second=c+60}else{this.second=c}},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM";this.update()},getTemplate:function(){if(this.options.templates[this.options.template]){return this.options.templates[this.options.template]}if(this.showInputs){var g='<input type="text" name="hour" class="bootstrap-timepicker-hour" maxlength="2"/>';var d='<input type="text" name="minute" class="bootstrap-timepicker-minute" maxlength="2"/>';var c='<input type="text" name="second" class="bootstrap-timepicker-second" maxlength="2"/>';var f='<input type="text" name="meridian" class="bootstrap-timepicker-meridian" maxlength="2"/>'}else{var g='<span class="bootstrap-timepicker-hour"></span>';var d='<span class="bootstrap-timepicker-minute"></span>';var c='<span class="bootstrap-timepicker-second"></span>';var f='<span class="bootstrap-timepicker-meridian"></span>'}var h='<table class="'+(this.showSeconds?"show-seconds":"")+" "+(this.showMeridian?"show-meridian":"")+'"><tr><td><a href="#" data-action="incrementHour"><i class="icon-chevron-up"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="icon-chevron-up"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="icon-chevron-up"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="icon-chevron-up"></i></a></td>':"")+"</tr><tr><td>"+g+'</td> <td class="separator">:</td><td>'+d+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+c+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+f+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="icon-chevron-down"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="icon-chevron-down"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="icon-chevron-down"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="icon-chevron-down"></i></a></td>':"")+"</tr></table>";var e;switch(this.options.template){case"modal":e='<div class="bootstrap-timepicker modal hide fade in" style="top: 30%; margin-top: 0; width: 200px; margin-left: -100px;" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">×</a><h3>Pick a Time</h3></div><div class="modal-content">'+h+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">Ok</a></div></div>';break;case"dropdown":e='<div class="bootstrap-timepicker dropdown-menu">'+h+"</div>";break}return e}};b.fn.timepicker=function(c){return this.each(function(){var f=b(this),e=f.data("timepicker"),d=typeof c=="object"&&c;if(!e){f.data("timepicker",(e=new a(this,d)))}if(typeof c=="string"){e[c]()}})};b.fn.timepicker.defaults={minuteStep:15,secondStep:15,disableFocus:false,defaultTime:"current",showSeconds:false,showInputs:true,showMeridian:true,template:"dropdown",modalBackdrop:false,templates:{}};b.fn.timepicker.Constructor=a}(window.jQuery);"use strict";var GtdHeading,HeadingManager;GtdHeading=function(b){var c,d,a;if(!b){b={}}this.fields={archived:false,todo_state:null,text:"",scope:[],related_projects:[],tree_id:3,};this.fields.tree_id=4;this.pk=0;this.archived=false;this.populated=false;this.expandable="lazy";this.rank=1;this.state="closed";this.visible=false;this.fields.scope=[];this.children=new HeadingManager(b.workspace);this.set_fields(b);this.parent_obj=this.get_parent();if(this.workspace){if(this.parent_obj){this.rank=this.parent_obj.rank+1}}if(this.parent_obj){this.parent_obj.children.add(this)}};GtdHeading.prototype.set_fields=function(c){var f,g,e,b;b=this.pk;e=/^\d{4}-\d{2}-\d{2}[0-9:TZ]*/;if(c.pk!==undefined){this.pk=Number(c.pk)}if(typeof c.workspace!=="undefined"){this.workspace=c.workspace}this.model=c.model;try{if(c.fields.parent===this.pk){throw"bad parent"}}catch(a){if(a==="bad parent"){console.error("Cannot create node as a child of itself");throw a}}jQuery.extend(this.fields,c.fields)};GtdHeading.prototype.get_todo_state=function(){var d,b,c,a;d=null;if(typeof this.workspace!=="undefined"){for(b=0;b<this.workspace.todo_states.length;b+=1){c=this.workspace.todo_states[b];if(c.pk===Number(this.todo_state)){d=c}}}if(d){a=d}else{a={pk:this.todo_state}}return a};GtdHeading.prototype.get_title=function(){var a;a=this.title;if(this.archived){a='<span class="archived-text">'+a+"</span>"}return a};GtdHeading.prototype.get_previous_sibling=function(){var b,c,a;b=null;if(this.level===0){c=this.fields.tree_id;while(c>1&&b===null){c=c-1;b=this.workspace.headings.get({tree_id:c,level:0,})}}else{a=this.fields.lft;while(a>1&&b===null){a=a-2;b=this.workspace.headings.get({tree_id:this.fields.tree_id,level:this.level,parent:this.fields.parent,lft:a})}}return b};GtdHeading.prototype.get_parent=function(){var a;if(this.rank>0&&this.workspace){if(this.fields.parent===null){a=this.workspace.headings.get({pk:0});a=a||this.workspace}else{a=this.workspace.headings.get({pk:this.fields.parent})}}else{a=null}return a};GtdHeading.prototype.get_children=function(){var a;if(this.rank===0){a=this.workspace.headings.filter_by({rank:1})}else{a=this.workspace.headings.filter_by({parent:this.pk}).order_by("lft")}return a};GtdHeading.prototype.refresh_tree=function(){var a,b,c,d;a="/gtd/tree/"+this.fields.tree_id+"/";c=this;$.get(a,function(e){while(typeof e==="string"){e=$.parseJSON(e)}for(b=0;b<e.length;b+=1){d=new GtdHeading(e[b]);c.workspace.headings.add(d)}})};GtdHeading.prototype.is_leaf_node=function(){var a;if(this.fields.rght-this.fields.lft===1){a=true}else{if(this.fields.rght-this.fields.lft>1){a=false}else{a=undefined}}return a};GtdHeading.prototype.is_expandable=function(){var b,c,a;b=false;if(this.rank===0){b=true}if(this.text){b=true}else{if(this.workspace.show_all){if(this.workspace.active_scope){b=this.get_children().filter_by({scope:this.workspace.active_scope}).length}else{b=!this.is_leaf_node()}}else{c=this.get_children();if(this.workspace.active_scope){c=c.filter_by({scope:this.workspace.active_scope})}if(c.filter_by({archived:false}).length){b=true}else{if(this.populated===false&&!this.is_leaf_node()){b=true}}}}if(b){a=true}else{a=false}return a};GtdHeading.prototype.is_visible=function(){var a,b;a=this.visible;b=this.workspace?this.workspace.show_all:false;if(this.archived&&!b){a=false}return a};GtdHeading.prototype.update=function(){var a;a=/\S+/;if(a.test(this.fields.text)){this.expandable="yes"}else{if(this.populated){if(this.children.length>0){this.expandable="yes"}else{this.expandable="no"}}}this.todo_state=this.workspace.todo_states.get({pk:this.fields.todo_state});this.children=this.workspace.headings.filter_by({parent:this.pk})};GtdHeading.prototype.save=function(b){var a,f,d,c,e;e=this;if(b===undefined){b={}}c=b.auto?true:false;a="/gtd/node/";e.fields.auto_update=c;d={pk:e.pk,model:e.model,fields:e.fields,};if(e.pk>0){a+=e.pk+"/";f="PUT"}else{f="POST"}jQuery.ajax(a,{type:f,data:JSON.stringify(d),contentType:"application/json",success:function(i,g,h){e.workspace.$apply(function(){var j;j=jQuery.parseJSON(i);e.fields=j.fields;e.update()})},error:function(i,g,h){alert("Not saved");console.error(i.responseText)},})};GtdHeading.prototype.move_to=function(h,d){var g,c,b,a,f,e;g=this;b=true;if(d===undefined){d={}}if(d.position===undefined){d.position="first-child"}if(d.save===undefined){d.save=false}a=function(){var i=true;if(g.fields.tree_id===h.fields.tree_id){if(g===h){console.error("GtdHeading refusing to move relative to itself");i=false}else{if(h.fields.lft>g.fields.lft&&h.fields.rght<g.fields.rght){console.error("GtdHeading refusing to move relative to its own child");i=false}}}return i};f=function(){var i=a();if(i===true){g.fields.parent=h.pk;g.fields.tree_id=h.fields.tree_id;g.level=h.level+1;g.rank=h.rank+1}return i};e=function(){var i=a();if(i===true){g.fields.parent=h.fields.parent;g.fields.tree_id=h.fields.tree_id;g.level=h.level;g.rank=h.rank}return i};c={"first-child":function(){var i=f();if(i===true){g.fields.lft=-1}return i},"last-child":function(){var j,i;j=f();if(j===true){i=h.get_children();g.fields.lft=i[i.length-1].fields.lft+1}return j},left:function(){var i=e();if(i===true){g.fields.lft=h.fields.lft-1}return i},right:function(){var i=e();if(i===true){g.fields.lft=h.fields.lft+1}return i}};if(typeof c[d.position]==="function"){b=c[d.position]()}else{b=false}if(b===true){h.update();g.rebuild()}return b};GtdHeading.prototype.rebuild=function(){var a,b;a=this.workspace.headings.get({tree_id:this.fields.tree_id,rank:1});b=function(f,g){var e,c,d;f.fields.lft=g;e=f.get_children();c=g+1;for(d=0;d<e.length;d+=1){c=b(e[d],c)+1}f.fields.rght=c;return c};if(a.fields.lft===undefined){a.fields.lft=1}b(a,a.fields.lft)};GtdHeading.prototype.has_scope=function(b){var a;if(b===0){a=true}else{if((b===-1)&&(this.scope.length===0)){a=true}else{if(jQuery.inArray(b,this.scope)>-1){a=true}else{a=false}}}return a};GtdHeading.prototype.set_indent=function(b,c){var a=(this.icon_width+4)*c;b.css("margin-left",a+"px")};GtdHeading.prototype.populate_children=function(b){var a,c,d;if(typeof b==="undefined"){b={}}a="/gtd/node/descendants/"+this.pk+"/";c=this;d=function(e){var f={offset:e.offset};$.getJSON(a,f,function(h,g,i){c.workspace.$apply(function(){var j,k,m,n,l;if(g==="success"){j=h;for(k=0;k<j.length;k+=1){m=j[k];m.workspace=c.workspace;n=new GtdHeading(m);l=n.get_parent();if(l||n.rank===1){n=c.workspace.headings.add(n)}if(l){l.children.add(n);if(l.state==="open"){n.visible=true}}}if(c.rank===0){c.populated=true}if(e.offset===1){c.populated=true;c.update()}else{if(e.offset===2){for(k=0;k<c.children.length;k+=1){c.children[k].populated=true;c.children[k].update()}}}if(e.callback){e.callback()}}})})};if(!this.populated){if(this.rank>0&&this.$children){this.$children.hide()}d({offset:1,callback:function(){if(!c.populated_level_2){d({offset:2});c.populated_level_2=true}}})}else{if(!this.populated_level_2){d({offset:2});this.populated_level_2=true}}};GtdHeading.prototype.toggle=function(a){this.populate_children();if(typeof a!=="undefined"){this.state=a}else{if(this.state==="open"){this.state="closed"}else{if(this.state==="closed"){this.state="open"}}}};var HeadingManager=function(a){var b=[];b.workspace=a;return b};Array.prototype.get=function(c){var b,a;a=this.filter_by(c);if(a.length===1){b=a[0]}else{if(a.length>1){console.error("HeadingManager.get():query did not produce unique result. Returning first result");console.log(c);console.log(a);b=a[0]}else{b=null}}return b};Array.prototype.filter_by=function(g){var a,c,e,f,b,d;a=[];for(c=0;c<this.length;c+=1){e=this[c];if(e.rank===0){f=false}else{f=true}for(b in g){if(g.hasOwnProperty(b)){if(typeof e.fields!=="undefined"){if(Object.keys(e.fields).indexOf(b)>-1){d=e.fields}else{d=e}}else{d=e}if(d[b] instanceof Array){if(g[b] instanceof Array){if(!(($(e.scope).not([]).length===0&&$([]).not(e.scope).length===0)&&typeof e.scope!=="undefined")){f=false}}else{if(jQuery.inArray(g[b],d[b])<0){f=false}}}else{if(d[b]!==g[b]){f=false}}}}if(f){a.push(e)}}return a};Array.prototype.order_by=function(d){var a,b,c;a=/^(-)?(\S*)$/.exec(d);b=this.slice(0);c=function(f,e){var i,h,g;i=Number(f[a[2]]);h=Number(e[a[2]]);if(i&&h){g=i-h}else{if(f<e){g=-1}else{if(f>e){g=1}else{g=0}}}return g};b.sort(c);if(a[1]==="-"){b.reverse()}return b};Array.prototype.add=function(g){var d,f,c,a,e,h,b;d=this;c=["pk","populated","text","todo_state","archived","rank","scope","related_projects","parent"];e=function(j){var i;f=d.get({pk:j.pk});if(f){j.populated=f.populated;for(i in j){if(j.hasOwnProperty(i)){f[i]=j[i]}}a=f}else{d.push(j);a=j}a.update();return a};if(g.length>1){for(b=0;b<g.length;b+=1){h=new GtdHeading(g[b]);e(h)}}else{a=e(g)}return a};"use strict";var gtd_module=angular.module("orgWolf",["ngAnimate","ngResource","ngSanitize"]);gtd_module.config(function(c){c.defaults.headers.common["X-Request-With"]="XMLHttpRequest";function a(d){var h,g,f,e;h=null;if(document.cookie&&document.cookie!==""){g=document.cookie.split(";");for(f=0;f<g.length;f+=1){e=jQuery.trim(g[f]);if(e.substring(0,d.length+1)===(d+"=")){h=decodeURIComponent(e.substring(d.length+1));break}}}return h}var b=a("csrftoken");$.ajaxSetup({beforeSend:function(d){d.setRequestHeader("X-CSRFToken",b)}})});gtd_module.factory("Heading",function(){return function(a){return new GtdHeading(a)}});gtd_module.filter("style",function(){return function(e){var d,f,a,b;d="";if(e===null||e===undefined){d=null}else{if(e.model==="gtd.todostate"){f={};f.RED_OFFSET=16;f.GREEN_OFFSET=8;f.BLUE_OFFSET=0;f.RED_MASK=16711680;f.GREEN_MASK=65280;f.BLUE_MASK=255;f.red=(e.fields._color_rgb&f.RED_MASK)>>f.RED_OFFSET;f.green=(e.fields._color_rgb&f.GREEN_MASK)>>f.GREEN_OFFSET;f.blue=(e.fields._color_rgb&f.BLUE_MASK)>>f.BLUE_OFFSET;d+="color: rgba("+f.red+", "+f.green+", "+f.blue;d+=", "+e.fields._color_alpha+"); ";if(e.fields.actionable){d+="font-weight: bold; "}}else{if(e.model==="gtd.node"){a=["rgb(88, 0, 176)","rgb(80, 0, 0)","rgb(0, 44, 19)","teal","slateblue","brown"];b=(e.rank-1)%a.length;d+="color: "+a[b]+"; "}}}return d}});gtd_module.filter("asHtml",function(a){return function(c){var b=a.trustAsHtml(c);return b}});gtd_module.directive("owEditable",function(){function a(f,d,c){var e,g,b;f.fields=jQuery.extend(true,{},f.heading.fields);f.priorities=[{sym:"A",display:"A - high"},{sym:"B",display:"B - medium (default)"},{sym:"C",display:"C - low"}];f.time_units=[{value:"d",label:"Days"},{value:"w",label:"Weeks"},{value:"m",label:"Months"},{value:"y",label:"Years"},];f.repeat_schemes=[{value:false,label:"scheduled date"},{value:true,label:"completion date"},];e=d.find(".edit-text");b=d.find("#edit-save");$("body").animate({scrollTop:d.offset().top-27},"500");d.find(".make-switch").each(function(){var h;h=$(this).find("input").attr("ng-model").split(".")[1];$(this).bootstrapSwitch();$(this).bootstrapSwitch("setState",f.fields[h])});d.find(".make-switch").on("switch-change",function(j,h){var i;i=$(j.target).find("input").attr("ng-model").split(".")[1];f.fields[i]=h.value});Aloha.ready(function(){Aloha.jQuery(d.find(".edit-text")).aloha()});f.save=function(h){f.fields.text=d.find(".edit-text")[0].innerHTML;f.heading.fields=f.fields;f.heading.update();f.heading.editable=false;f.heading.save()};f.cancel=function(h){f.heading.editable=false};console.log(f.heading)}return{link:a}});gtd_module.directive("owTodo",function(b){function a(o,g,n){var h,m,f,j,d,l,p,c;c=b("style");o.heading.todo_popover=false;if(o.heading.todo_state){g.tooltip({delay:{show:1000,hide:100},title:o.heading.todo_state.fields.display_text,placement:"right"})}m=g.children("span");function e(i){i.popover("destroy")}function k(i){$("body").append('<div id="todo-popover"></div>');l='<div class="todo-option" todo_id=""';if(o.heading.fields.todo_state===null){l+=" selected"}l+=">[None]</div>\n";for(h=0;h<o.todo_states.length;h+=1){d=o.todo_states[h];p='<div class="todo-option" todo_id="'+d.pk+'"';p+='style="'+c(d)+'"';if(d.pk===o.heading.fields.todo_state){p+=" selected"}p+=">"+d.fields.abbreviation+"</div>\n";l+=p}i.popover({title:"Todo State",content:l,html:true,container:"#todo-popover"});i.popover("show");$("body").on("click.todo_state",function(q){if(!$(q.target).hasClass("todo-state")){i.popover("destroy")}});j=$(".todo-option").not("[selected]");j.on("click.todostate",function(q){o.$apply(function(){var r=$(q.target).attr("todo_id");if(r===""){o.heading.fields.todo_state=null}else{o.heading.fields.todo_state=parseInt(r,10)}o.heading.update();o.heading.save({auto:true});e(i);return false})})}m.on("click",function(i){k(m)})}return{link:a,templateUrl:"todo-state-selector",}});gtd_module.controller("nodeOutline",function(c,h,e,f,b){var a,d,g;c.headings=new HeadingManager(c);c.children=new HeadingManager(c);c.parent_id=b.attr("parent_id");if(c.parent_id===""){c.parent_id=0}else{c.parent_id=parseInt(c.parent_id,10)}c.show_arx=false;c.state="open";c.rank=0;a=e("/gtd/todostate/");c.todo_states=a.query();d="/gtd/node/descendants/"+c.parent_id+"/";h({method:"GET",url:d}).success(function(m,j,n,k){var l;for(l=0;l<m.length;l+=1){m[l].workspace=c}c.headings.add(m);c.rank1_headings=c.headings.filter_by({rank:1})}).error(function(k,i,l,j){console.error("fail!")});g=function(l){var i,k,j;i=$(l.delegateTarget).closest(".heading");j=Number(i.attr("node_id"));k=c.headings.get({pk:j});return k};c.toggle_node=function(l){var i,j,k,m;i=$(l.target);k=g(l);if(i.hasClass("edit-btn")){k.populate_children();k.editable=true}else{if(i.hasClass("todo-state")){console.log("todo-state clicked")}else{if(i.hasClass("archive-btn")){if(k.fields.archived){k.fields.archived=false}else{k.fields.archived=true}k.save()}else{if(i.hasClass("new-btn")){m=new f({workspace:k.workspace,fields:{title:"",parent:k.pk}});m.editable=true;k.children.add(m);k.toggle("open")}else{k.toggle()}}}}};c.show_all=function(i){if(c.show_arx===true){c.show_arx=false}else{c.show_arx=true}};c.edit_cancel=function(j){var i;i=g(j);i.editable=false}});"use strict";$(document).ready(function(){var b,a;b=$(".login");b.before('<a href="#" class="persona-button"><span>Sign in with your Email</span></a>');a=b.prev("a.persona-button");if(b.hasClass("replace")){b.removeClass("row");b.html('<div><a href="/accounts/login/">Other login methods</a></div>');b.append('<div><a href="/accounts/register/">Other new user creation methods</a></div>')}a.bind("click.persona",function(c){navigator.id.request();$(this).attr("data-loading-text","Loading...")});$("#logout").bind("click.persona",function(c){console.log("logout");navigator.id.logout()});navigator.id.watch({loggedInUser:persona_user,onlogin:function(c){ow_waiting("spinner");console.log(c);$.ajax({type:"POST",url:"/accounts/login/persona/?next=/gtd/node/",data:{assertion:c},success:function(e,d,f){e=$.parseJSON(e);window.location.href=e.next},error:function(f,d,e){navigator.id.logout();alert("Login failure: "+e)}})},onlogout:function(){$.ajax({type:"POST",url:"/accounts/logout/persona/",success:function(d,c,e){},error:function(e,c,d){alert("Logout failure: "+d)}})}})});