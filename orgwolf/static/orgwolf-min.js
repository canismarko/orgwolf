/*!
 * jQuery Cookie Plugin v1.3
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function(f,b,g){var a=/\+/g;function e(h){return h}function c(h){return decodeURIComponent(h.replace(a," "))}var d=f.cookie=function(p,o,u){if(o!==g){u=f.extend({},d.defaults,u);if(o===null){u.expires=-1}if(typeof u.expires==="number"){var q=u.expires,s=u.expires=new Date();s.setDate(s.getDate()+q)}o=d.json?JSON.stringify(o):String(o);return(b.cookie=[encodeURIComponent(p),"=",d.raw?o:encodeURIComponent(o),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join(""))}var h=d.raw?e:c;var r=b.cookie.split("; ");for(var n=0,k=r.length;n<k;n++){var m=r[n].split("=");if(h(m.shift())===p){var j=h(m.join("="));return d.json?JSON.parse(j):j}}return null};d.defaults={};f.removeCookie=function(i,h){if(f.cookie(i)!==null){f.cookie(i,null,h);return true}return false}})(jQuery,document);(function(h){var c=h(window);function k(){return new Date(Date.UTC.apply(Date,arguments))}function e(){var n=new Date();return k(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate())}var i=function(o,n){var p=this;this._process_options(n);this.element=h(o);this.isInline=false;this.isInput=this.element.is("input");this.component=this.element.is(".date")?this.element.find(".add-on, .input-group-addon, .btn"):false;this.hasInput=this.component&&this.element.find("input").length;if(this.component&&this.component.length===0){this.component=false}this.picker=h(j.template);this._buildEvents();this._attachEvents();if(this.isInline){this.picker.addClass("datepicker-inline").appendTo(this.element)}else{this.picker.addClass("datepicker-dropdown dropdown-menu")}if(this.o.rtl){this.picker.addClass("datepicker-rtl");this.picker.find(".prev i, .next i").toggleClass("icon-arrow-left icon-arrow-right")}this.viewMode=this.o.startView;if(this.o.calendarWeeks){this.picker.find("tfoot th.today").attr("colspan",function(q,r){return parseInt(r)+1})}this._allow_update=false;this.setStartDate(this._o.startDate);this.setEndDate(this._o.endDate);this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled);this.fillDow();this.fillMonths();this._allow_update=true;this.update();this.showMode();if(this.isInline){this.show()}};i.prototype={constructor:i,_process_options:function(n){this._o=h.extend({},this._o,n);var s=this.o=h.extend({},this._o);var r=s.language;if(!b[r]){r=r.split("-")[0];if(!b[r]){r=f.language}}s.language=r;switch(s.startView){case 2:case"decade":s.startView=2;break;case 1:case"year":s.startView=1;break;default:s.startView=0}switch(s.minViewMode){case 1:case"months":s.minViewMode=1;break;case 2:case"years":s.minViewMode=2;break;default:s.minViewMode=0}s.startView=Math.max(s.startView,s.minViewMode);s.weekStart%=7;s.weekEnd=((s.weekStart+6)%7);var p=j.parseFormat(s.format);if(s.startDate!==-Infinity){if(!!s.startDate){if(s.startDate instanceof Date){s.startDate=this._local_to_utc(this._zero_time(s.startDate))}else{s.startDate=j.parseDate(s.startDate,p,s.language)}}else{s.startDate=-Infinity}}if(s.endDate!==Infinity){if(!!s.endDate){if(s.endDate instanceof Date){s.endDate=this._local_to_utc(this._zero_time(s.endDate))}else{s.endDate=j.parseDate(s.endDate,p,s.language)}}else{s.endDate=Infinity}}s.daysOfWeekDisabled=s.daysOfWeekDisabled||[];if(!h.isArray(s.daysOfWeekDisabled)){s.daysOfWeekDisabled=s.daysOfWeekDisabled.split(/[,\s]*/)}s.daysOfWeekDisabled=h.map(s.daysOfWeekDisabled,function(o){return parseInt(o,10)});var q=String(s.orientation).toLowerCase().split(/\s+/g),t=s.orientation.toLowerCase();q=h.grep(q,function(o){return(/^auto|left|right|top|bottom$/).test(o)});s.orientation={x:"auto",y:"auto"};if(!t||t==="auto"){}else{if(q.length===1){switch(q[0]){case"top":case"bottom":s.orientation.y=q[0];break;case"left":case"right":s.orientation.x=q[0];break}}else{t=h.grep(q,function(o){return(/^left|right$/).test(o)});s.orientation.x=t[0]||"auto";t=h.grep(q,function(o){return(/^top|bottom$/).test(o)});s.orientation.y=t[0]||"auto"}}},_events:[],_secondaryEvents:[],_applyEvents:function(n){for(var o=0,p,q;o<n.length;o++){p=n[o][0];q=n[o][1];p.on(q)}},_unapplyEvents:function(n){for(var o=0,p,q;o<n.length;o++){p=n[o][0];q=n[o][1];p.off(q)}},_buildEvents:function(){if(this.isInput){this._events=[[this.element,{focus:h.proxy(this.show,this),keyup:h.proxy(this.update,this),keydown:h.proxy(this.keydown,this)}]]}else{if(this.component&&this.hasInput){this._events=[[this.element.find("input"),{focus:h.proxy(this.show,this),keyup:h.proxy(this.update,this),keydown:h.proxy(this.keydown,this)}],[this.component,{click:h.proxy(this.show,this)}]]}else{if(this.element.is("div")){this.isInline=true}else{this._events=[[this.element,{click:h.proxy(this.show,this)}]]}}}this._secondaryEvents=[[this.picker,{click:h.proxy(this.click,this)}],[h(window),{resize:h.proxy(this.place,this)}],[h(document),{"mousedown touchstart":h.proxy(function(n){if(!(this.element.is(n.target)||this.element.find(n.target).length||this.picker.is(n.target)||this.picker.find(n.target).length)){this.hide()}},this)}]]},_attachEvents:function(){this._detachEvents();this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents();this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(p,q){var o=q||this.date,n=this._utc_to_local(o);this.element.trigger({type:p,date:n,format:h.proxy(function(s){var r=s||this.o.format;return j.formatDate(o,r,this.o.language)},this)})},show:function(n){if(!this.isInline){this.picker.appendTo("body")}this.picker.show();this.height=this.component?this.component.outerHeight():this.element.outerHeight();this.place();this._attachSecondaryEvents();if(n){n.preventDefault()}this._trigger("show")},hide:function(n){if(this.isInline){return}if(!this.picker.is(":visible")){return}this.picker.hide().detach();this._detachSecondaryEvents();this.viewMode=this.o.startView;this.showMode();if(this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())){this.setValue()}this._trigger("hide")},remove:function(){this.hide();this._detachEvents();this._detachSecondaryEvents();this.picker.remove();delete this.element.data().datepicker;if(!this.isInput){delete this.element.data().date}},_utc_to_local:function(n){return new Date(n.getTime()+(n.getTimezoneOffset()*60000))},_local_to_utc:function(n){return new Date(n.getTime()-(n.getTimezoneOffset()*60000))},_zero_time:function(n){return new Date(n.getFullYear(),n.getMonth(),n.getDate())},_zero_utc_time:function(n){return new Date(Date.UTC(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()))},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return this.date},setDate:function(n){this.setUTCDate(this._local_to_utc(n))},setUTCDate:function(n){this.date=n;this.setValue()},setValue:function(){var n=this.getFormattedDate();if(!this.isInput){if(this.component){this.element.find("input").val(n).change()}}else{this.element.val(n).change()}},getFormattedDate:function(n){if(n===undefined){n=this.o.format}return j.formatDate(this.date,n,this.o.language)},setStartDate:function(n){this._process_options({startDate:n});this.update();this.updateNavArrows()},setEndDate:function(n){this._process_options({endDate:n});this.update();this.updateNavArrows()},setDaysOfWeekDisabled:function(n){this._process_options({daysOfWeekDisabled:n});this.update();this.updateNavArrows()},place:function(){if(this.isInline){return}var B=this.picker.outerWidth(),x=this.picker.outerHeight(),r=10,t=c.width(),o=c.height(),s=c.scrollTop();var z=parseInt(this.element.parents().filter(function(){return h(this).css("z-index")!="auto"}).first().css("z-index"))+10;var w=this.component?this.component.parent().offset():this.element.offset();var A=this.component?this.component.outerHeight(true):this.element.outerHeight(false);var q=this.component?this.component.outerWidth(true):this.element.outerWidth(false);var v=w.left,y=w.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left");if(this.o.orientation.x!=="auto"){this.picker.addClass("datepicker-orient-"+this.o.orientation.x);if(this.o.orientation.x==="right"){v-=B-q}}else{this.picker.addClass("datepicker-orient-left");if(w.left<0){v-=w.left-r}else{if(w.left+B>t){v=t-B-r}}}var n=this.o.orientation.y,p,u;if(n==="auto"){p=-s+w.top-x;u=s+o-(w.top+A+x);if(Math.max(p,u)===u){n="top"}else{n="bottom"}}this.picker.addClass("datepicker-orient-"+n);if(n==="top"){y+=A}else{y-=x+parseInt(this.picker.css("padding-top"))}this.picker.css({top:y,left:v,zIndex:z})},_allow_update:true,update:function(){if(!this._allow_update){return}var p=new Date(this.date),n,o=false;if(arguments&&arguments.length&&(typeof arguments[0]==="string"||arguments[0] instanceof Date)){n=arguments[0];if(n instanceof Date){n=this._local_to_utc(n)}o=true}else{n=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val();delete this.element.data().date}this.date=j.parseDate(n,this.o.format,this.o.language);if(o){this.setValue()}else{if(n){if(p.getTime()!==this.date.getTime()){this._trigger("changeDate")}}else{this._trigger("clearDate")}}if(this.date<this.o.startDate){this.viewDate=new Date(this.o.startDate);this.date=new Date(this.o.startDate)}else{if(this.date>this.o.endDate){this.viewDate=new Date(this.o.endDate);this.date=new Date(this.o.endDate)}else{this.viewDate=new Date(this.date);this.date=new Date(this.date)}}this.fill()},fillDow:function(){var o=this.o.weekStart,p="<tr>";if(this.o.calendarWeeks){var n='<th class="cw">&nbsp;</th>';p+=n;this.picker.find(".datepicker-days thead tr:first-child").prepend(n)}while(o<this.o.weekStart+7){p+='<th class="dow">'+b[this.o.language].daysMin[(o++)%7]+"</th>"}p+="</tr>";this.picker.find(".datepicker-days thead").append(p)},fillMonths:function(){var o="",n=0;while(n<12){o+='<span class="month">'+b[this.o.language].monthsShort[n++]+"</span>"}this.picker.find(".datepicker-months td").html(o)},setRange:function(n){if(!n||!n.length){delete this.range}else{this.range=h.map(n,function(o){return o.valueOf()})}this.fill()},getClassNames:function(q){var o=[],r=this.viewDate.getUTCFullYear(),s=this.viewDate.getUTCMonth(),n=this.date.valueOf(),p=new Date();if(q.getUTCFullYear()<r||(q.getUTCFullYear()==r&&q.getUTCMonth()<s)){o.push("old")}else{if(q.getUTCFullYear()>r||(q.getUTCFullYear()==r&&q.getUTCMonth()>s)){o.push("new")}}if(this.o.todayHighlight&&q.getUTCFullYear()==p.getFullYear()&&q.getUTCMonth()==p.getMonth()&&q.getUTCDate()==p.getDate()){o.push("today")}if(q.valueOf()==n){o.push("active")}if(q.valueOf()<this.o.startDate||q.valueOf()>this.o.endDate||h.inArray(q.getUTCDay(),this.o.daysOfWeekDisabled)!==-1){o.push("disabled")}if(this.range){if(q>this.range[0]&&q<this.range[this.range.length-1]){o.push("range")}if(h.inArray(q.valueOf(),this.range)!=-1){o.push("selected")}}return o},fill:function(){var F=new Date(this.viewDate),w=F.getUTCFullYear(),G=F.getUTCMonth(),A=this.o.startDate!==-Infinity?this.o.startDate.getUTCFullYear():-Infinity,E=this.o.startDate!==-Infinity?this.o.startDate.getUTCMonth():-Infinity,t=this.o.endDate!==Infinity?this.o.endDate.getUTCFullYear():Infinity,B=this.o.endDate!==Infinity?this.o.endDate.getUTCMonth():Infinity,u=this.date&&this.date.valueOf(),q;this.picker.find(".datepicker-days thead th.datepicker-switch").text(b[this.o.language].months[G]+" "+w);this.picker.find("tfoot th.today").text(b[this.o.language].today).toggle(this.o.todayBtn!==false);this.picker.find("tfoot th.clear").text(b[this.o.language].clear).toggle(this.o.clearBtn!==false);this.updateNavArrows();this.fillMonths();var I=k(w,G-1,28,0,0,0,0),D=j.getDaysInMonth(I.getUTCFullYear(),I.getUTCMonth());I.setUTCDate(D);I.setUTCDate(D-(I.getUTCDay()-this.o.weekStart+7)%7);var n=new Date(I);n.setUTCDate(n.getUTCDate()+42);n=n.valueOf();var v=[];var z;while(I.valueOf()<n){if(I.getUTCDay()==this.o.weekStart){v.push("<tr>");if(this.o.calendarWeeks){var o=new Date(+I+(this.o.weekStart-I.getUTCDay()-7)%7*86400000),r=new Date(+o+(7+4-o.getUTCDay())%7*86400000),p=new Date(+(p=k(r.getUTCFullYear(),0,1))+(7+4-p.getUTCDay())%7*86400000),x=(r-p)/86400000/7+1;v.push('<td class="cw">'+x+"</td>")}}z=this.getClassNames(I);z.push("day");if(this.o.beforeShowDay!==h.noop){var y=this.o.beforeShowDay(this._utc_to_local(I));if(y===undefined){y={}}else{if(typeof(y)==="boolean"){y={enabled:y}}else{if(typeof(y)==="string"){y={classes:y}}}}if(y.enabled===false){z.push("disabled")}if(y.classes){z=z.concat(y.classes.split(/\s+/))}if(y.tooltip){q=y.tooltip}}z=h.unique(z);v.push('<td class="'+z.join(" ")+'"'+(q?' title="'+q+'"':"")+">"+I.getUTCDate()+"</td>");if(I.getUTCDay()==this.o.weekEnd){v.push("</tr>")}I.setUTCDate(I.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(v.join(""));var J=this.date&&this.date.getUTCFullYear();var s=this.picker.find(".datepicker-months").find("th:eq(1)").text(w).end().find("span").removeClass("active");if(J&&J==w){s.eq(this.date.getUTCMonth()).addClass("active")}if(w<A||w>t){s.addClass("disabled")}if(w==A){s.slice(0,E).addClass("disabled")}if(w==t){s.slice(B+1).addClass("disabled")}v="";w=parseInt(w/10,10)*10;var H=this.picker.find(".datepicker-years").find("th:eq(1)").text(w+"-"+(w+9)).end().find("td");w-=1;for(var C=-1;C<11;C++){v+='<span class="year'+(C==-1?" old":C==10?" new":"")+(J==w?" active":"")+(w<A||w>t?" disabled":"")+'">'+w+"</span>";w+=1}H.html(v)},updateNavArrows:function(){if(!this._allow_update){return}var p=new Date(this.viewDate),n=p.getUTCFullYear(),o=p.getUTCMonth();switch(this.viewMode){case 0:if(this.o.startDate!==-Infinity&&n<=this.o.startDate.getUTCFullYear()&&o<=this.o.startDate.getUTCMonth()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.o.endDate!==Infinity&&n>=this.o.endDate.getUTCFullYear()&&o>=this.o.endDate.getUTCMonth()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break;case 1:case 2:if(this.o.startDate!==-Infinity&&n<=this.o.startDate.getUTCFullYear()){this.picker.find(".prev").css({visibility:"hidden"})}else{this.picker.find(".prev").css({visibility:"visible"})}if(this.o.endDate!==Infinity&&n>=this.o.endDate.getUTCFullYear()){this.picker.find(".next").css({visibility:"hidden"})}else{this.picker.find(".next").css({visibility:"visible"})}break}},click:function(r){r.preventDefault();var s=h(r.target).closest("span, td, th");if(s.length==1){switch(s[0].nodeName.toLowerCase()){case"th":switch(s[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var n=j.modes[this.viewMode].navStep*(s[0].className=="prev"?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,n);this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,n);if(this.viewMode===1){this._trigger("changeYear",this.viewDate)}break}this.fill();break;case"today":var o=new Date();o=k(o.getFullYear(),o.getMonth(),o.getDate(),0,0,0);this.showMode(-2);var p=this.o.todayBtn=="linked"?null:"view";this._setDate(o,p);break;case"clear":var q;if(this.isInput){q=this.element}else{if(this.component){q=this.element.find("input")}}if(q){q.val("").change()}this._trigger("changeDate");this.update();if(this.o.autoclose){this.hide()}break}break;case"span":if(!s.is(".disabled")){this.viewDate.setUTCDate(1);if(s.is(".month")){var v=1;var t=s.parent().find("span").index(s);var u=this.viewDate.getUTCFullYear();this.viewDate.setUTCMonth(t);this._trigger("changeMonth",this.viewDate);if(this.o.minViewMode===1){this._setDate(k(u,t,v,0,0,0,0))}}else{var u=parseInt(s.text(),10)||0;var v=1;var t=0;this.viewDate.setUTCFullYear(u);this._trigger("changeYear",this.viewDate);if(this.o.minViewMode===2){this._setDate(k(u,t,v,0,0,0,0))}}this.showMode(-1);this.fill()}break;case"td":if(s.is(".day")&&!s.is(".disabled")){var v=parseInt(s.text(),10)||1;var u=this.viewDate.getUTCFullYear(),t=this.viewDate.getUTCMonth();if(s.is(".old")){if(t===0){t=11;u-=1}else{t-=1}}else{if(s.is(".new")){if(t==11){t=0;u+=1}else{t+=1}}}this._setDate(k(u,t,v,0,0,0,0))}break}}},_setDate:function(n,p){if(!p||p=="date"){this.date=new Date(n)}if(!p||p=="view"){this.viewDate=new Date(n)}this.fill();this.setValue();this._trigger("changeDate");var o;if(this.isInput){o=this.element}else{if(this.component){o=this.element.find("input")}}if(o){o.change()}if(this.o.autoclose&&(!p||p=="date")){this.hide()}},moveMonth:function(n,o){if(!o){return n}var r=new Date(n.valueOf()),v=r.getUTCDate(),s=r.getUTCMonth(),q=Math.abs(o),u,t;o=o>0?1:-1;if(q==1){t=o==-1?function(){return r.getUTCMonth()==s}:function(){return r.getUTCMonth()!=u};u=s+o;r.setUTCMonth(u);if(u<0||u>11){u=(u+12)%12}}else{for(var p=0;p<q;p++){r=this.moveMonth(r,o)}u=r.getUTCMonth();r.setUTCDate(v);t=function(){return u!=r.getUTCMonth()}}while(t()){r.setUTCDate(--v);r.setUTCMonth(u)}return r},moveYear:function(o,n){return this.moveMonth(o,n*12)},dateWithinRange:function(n){return n>=this.o.startDate&&n<=this.o.endDate},keydown:function(u){if(this.picker.is(":not(:visible)")){if(u.keyCode==27){this.show()}return}var q=false,p,o,t,n,s;switch(u.keyCode){case 27:this.hide();u.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation){break}p=u.keyCode==37?-1:1;if(u.ctrlKey){n=this.moveYear(this.date,p);s=this.moveYear(this.viewDate,p);this._trigger("changeYear",this.viewDate)}else{if(u.shiftKey){n=this.moveMonth(this.date,p);s=this.moveMonth(this.viewDate,p);this._trigger("changeMonth",this.viewDate)}else{n=new Date(this.date);n.setUTCDate(this.date.getUTCDate()+p);s=new Date(this.viewDate);s.setUTCDate(this.viewDate.getUTCDate()+p)}}if(this.dateWithinRange(n)){this.date=n;this.viewDate=s;this.setValue();this.update();u.preventDefault();q=true}break;case 38:case 40:if(!this.o.keyboardNavigation){break}p=u.keyCode==38?-1:1;if(u.ctrlKey){n=this.moveYear(this.date,p);s=this.moveYear(this.viewDate,p);this._trigger("changeYear",this.viewDate)}else{if(u.shiftKey){n=this.moveMonth(this.date,p);s=this.moveMonth(this.viewDate,p);this._trigger("changeMonth",this.viewDate)}else{n=new Date(this.date);n.setUTCDate(this.date.getUTCDate()+p*7);s=new Date(this.viewDate);s.setUTCDate(this.viewDate.getUTCDate()+p*7)}}if(this.dateWithinRange(n)){this.date=n;this.viewDate=s;this.setValue();this.update();u.preventDefault();q=true}break;case 13:this.hide();u.preventDefault();break;case 9:this.hide();break}if(q){this._trigger("changeDate");var r;if(this.isInput){r=this.element}else{if(this.component){r=this.element.find("input")}}if(r){r.change()}}},showMode:function(n){if(n){this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+n))}this.picker.find(">div").hide().filter(".datepicker-"+j.modes[this.viewMode].clsName).css("display","block");this.updateNavArrows()}};var m=function(o,n){this.element=h(o);this.inputs=h.map(n.inputs,function(p){return p.jquery?p[0]:p});delete n.inputs;h(this.inputs).datepicker(n).bind("changeDate",h.proxy(this.dateUpdated,this));this.pickers=h.map(this.inputs,function(p){return h(p).data("datepicker")});this.updateDates()};m.prototype={updateDates:function(){this.dates=h.map(this.pickers,function(n){return n.date});this.updateRanges()},updateRanges:function(){var n=h.map(this.dates,function(o){return o.valueOf()});h.each(this.pickers,function(o,q){q.setRange(n)})},dateUpdated:function(q){var r=h(q.target).data("datepicker"),p=r.getUTCDate(),o=h.inArray(q.target,this.inputs),n=this.inputs.length;if(o==-1){return}if(p<this.dates[o]){while(o>=0&&p<this.dates[o]){this.pickers[o--].setUTCDate(p)}}else{if(p>this.dates[o]){while(o<n&&p>this.dates[o]){this.pickers[o++].setUTCDate(p)}}}this.updateDates()},remove:function(){h.map(this.pickers,function(n){n.remove()});delete this.element.data().datepicker}};function g(q,t){var s=h(q).data(),n={},r,p=new RegExp("^"+t.toLowerCase()+"([A-Z])"),t=new RegExp("^"+t.toLowerCase());for(var o in s){if(t.test(o)){r=o.replace(p,function(v,u){return u.toLowerCase()});n[r]=s[o]}}return n}function a(p){var n={};if(!b[p]){p=p.split("-")[0];if(!b[p]){return}}var o=b[p];h.each(l,function(r,q){if(q in o){n[q]=o[q]}});return n}var d=h.fn.datepicker;h.fn.datepicker=function(q){var o=Array.apply(null,arguments);o.shift();var p,n;this.each(function(){var y=h(this),w=y.data("datepicker"),s=typeof q=="object"&&q;if(!w){var u=g(this,"date"),r=h.extend({},f,u,s),t=a(r.language),v=h.extend({},f,t,u,s);if(y.is(".input-daterange")||v.inputs){var x={inputs:v.inputs||y.find("input").toArray()};y.data("datepicker",(w=new m(this,h.extend(v,x))))}else{y.data("datepicker",(w=new i(this,v)))}}if(typeof q=="string"&&typeof w[q]=="function"){p=w[q].apply(w,o);if(p!==undefined){return false}}});if(p!==undefined){return p}else{return this}};var f=h.fn.datepicker.defaults={autoclose:false,beforeShowDay:h.noop,calendarWeeks:false,clearBtn:false,daysOfWeekDisabled:[],endDate:Infinity,forceParse:true,format:"mm/dd/yyyy",keyboardNavigation:true,language:"en",minViewMode:0,orientation:"auto",rtl:false,startDate:-Infinity,startView:0,todayBtn:false,todayHighlight:false,weekStart:0};var l=h.fn.datepicker.locale_opts=["format","rtl","weekStart"];h.fn.datepicker.Constructor=i;var b=h.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}};var j={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(n){return(((n%4===0)&&(n%100!==0))||(n%400===0))},getDaysInMonth:function(n,o){return[31,(j.isLeapYear(n)?29:28),31,30,31,30,31,31,30,31,30,31][o]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(p){var n=p.replace(this.validParts,"\0").split("\0"),o=p.match(this.validParts);if(!n||!n.length||!o||o.length===0){throw new Error("Invalid date format.")}return{separators:n,parts:o}},parseDate:function(q,A,u){if(q instanceof Date){return q}if(typeof A==="string"){A=j.parseFormat(A)}if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(q)){var C=/([\-+]\d+)([dmwy])/,t=q.match(/([\-+]\d+)([dmwy])/g),n,r;q=new Date();for(var v=0;v<t.length;v++){n=C.exec(t[v]);r=parseInt(n[1]);switch(n[2]){case"d":q.setUTCDate(q.getUTCDate()+r);break;case"m":q=i.prototype.moveMonth.call(i.prototype,q,r);break;case"w":q.setUTCDate(q.getUTCDate()+r*7);break;case"y":q=i.prototype.moveYear.call(i.prototype,q,r);break}}return k(q.getUTCFullYear(),q.getUTCMonth(),q.getUTCDate(),0,0,0)}var t=q&&q.match(this.nonpunctuation)||[],q=new Date(),y={},z=["yyyy","yy","M","MM","m","mm","d","dd"],B={yyyy:function(F,s){return F.setUTCFullYear(s)},yy:function(F,s){return F.setUTCFullYear(2000+s)},m:function(F,s){if(isNaN(F)){return F}s-=1;while(s<0){s+=12}s%=12;F.setUTCMonth(s);while(F.getUTCMonth()!=s){F.setUTCDate(F.getUTCDate()-1)}return F},d:function(F,s){return F.setUTCDate(s)}},p,w,n;B.M=B.MM=B.mm=B.m;B.dd=B.d;q=k(q.getFullYear(),q.getMonth(),q.getDate(),0,0,0);var x=A.parts.slice();if(t.length!=x.length){x=h(x).filter(function(s,F){return h.inArray(F,z)!==-1}).toArray()}if(t.length==x.length){for(var v=0,o=x.length;v<o;v++){p=parseInt(t[v],10);n=x[v];if(isNaN(p)){switch(n){case"MM":w=h(b[u].months).filter(function(){var s=this.slice(0,t[v].length),F=t[v].slice(0,s.length);return s==F});p=h.inArray(w[0],b[u].months)+1;break;case"M":w=h(b[u].monthsShort).filter(function(){var s=this.slice(0,t[v].length),F=t[v].slice(0,s.length);return s==F});p=h.inArray(w[0],b[u].monthsShort)+1;break}}y[n]=p}for(var v=0,E,D;v<z.length;v++){D=z[v];if(D in y&&!isNaN(y[D])){E=new Date(q);B[D](E,y[D]);if(!isNaN(E)){q=E}}}}return q},formatDate:function(n,r,t){if(typeof r==="string"){r=j.parseFormat(r)}var s={d:n.getUTCDate(),D:b[t].daysShort[n.getUTCDay()],DD:b[t].days[n.getUTCDay()],m:n.getUTCMonth()+1,M:b[t].monthsShort[n.getUTCMonth()],MM:b[t].months[n.getUTCMonth()],yy:n.getUTCFullYear().toString().substring(2),yyyy:n.getUTCFullYear()};s.dd=(s.d<10?"0":"")+s.d;s.mm=(s.m<10?"0":"")+s.m;var n=[],q=h.extend([],r.separators);for(var p=0,o=r.parts.length;p<=o;p++){if(q.length){n.push(q.shift())}n.push(s[r.parts[p]])}return n.join("")},headTemplate:'<thead><tr><th class="prev">&laquo;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&raquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};j.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+j.headTemplate+"<tbody></tbody>"+j.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+j.headTemplate+j.contTemplate+j.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+j.headTemplate+j.contTemplate+j.footTemplate+"</table></div></div>";h.fn.datepicker.DPGlobal=j;h.fn.datepicker.noConflict=function(){h.fn.datepicker=d;return this};h(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(o){var n=h(this);if(n.data("datepicker")){return}o.preventDefault();n.datepicker("show")});h(function(){h('[data-provide="datepicker-inline"]').datepicker()})}(window.jQuery));/*!
 * Timepicker Component for Twitter Bootstrap
 *
 * Copyright 2013 Joris de Wit
 *
 * Contributors https://github.com/jdewit/bootstrap-timepicker/graphs/contributors
 *
 * For the full copyright and license information, please view the LICENSE
 * file that was distributed with this source code.
 */
(function(d,c,a,e){var b=function(g,f){this.widget="";this.$element=d(g);this.defaultTime=f.defaultTime;this.disableFocus=f.disableFocus;this.disableMousewheel=f.disableMousewheel;this.isOpen=f.isOpen;this.minuteStep=f.minuteStep;this.modalBackdrop=f.modalBackdrop;this.orientation=f.orientation;this.secondStep=f.secondStep;this.showInputs=f.showInputs;this.showMeridian=f.showMeridian;this.showSeconds=f.showSeconds;this.template=f.template;this.appendWidgetTo=f.appendWidgetTo;this.showWidgetOnAddonClick=f.showWidgetOnAddonClick;this._init()};b.prototype={constructor:b,_init:function(){var f=this;if(this.showWidgetOnAddonClick&&(this.$element.parent().hasClass("input-append")||this.$element.parent().hasClass("input-prepend"))){this.$element.parent(".input-append, .input-prepend").find(".add-on").on({"click.timepicker":d.proxy(this.showWidget,this)});this.$element.on({"focus.timepicker":d.proxy(this.highlightUnit,this),"click.timepicker":d.proxy(this.highlightUnit,this),"keydown.timepicker":d.proxy(this.elementKeydown,this),"blur.timepicker":d.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":d.proxy(this.mousewheel,this)})}else{if(this.template){this.$element.on({"focus.timepicker":d.proxy(this.showWidget,this),"click.timepicker":d.proxy(this.showWidget,this),"blur.timepicker":d.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":d.proxy(this.mousewheel,this)})}else{this.$element.on({"focus.timepicker":d.proxy(this.highlightUnit,this),"click.timepicker":d.proxy(this.highlightUnit,this),"keydown.timepicker":d.proxy(this.elementKeydown,this),"blur.timepicker":d.proxy(this.blurElement,this),"mousewheel.timepicker DOMMouseScroll.timepicker":d.proxy(this.mousewheel,this)})}}if(this.template!==false){this.$widget=d(this.getTemplate()).on("click",d.proxy(this.widgetClick,this))}else{this.$widget=false}if(this.showInputs&&this.$widget!==false){this.$widget.find("input").each(function(){d(this).on({"click.timepicker":function(){d(this).select()},"keydown.timepicker":d.proxy(f.widgetKeydown,f),"keyup.timepicker":d.proxy(f.widgetKeyup,f)})})}this.setDefaultTime(this.defaultTime)},blurElement:function(){this.highlightedUnit=null;this.updateFromElementVal()},clear:function(){this.hour="";this.minute="";this.second="";this.meridian="";this.$element.val("")},decrementHour:function(){if(this.showMeridian){if(this.hour===1){this.hour=12}else{if(this.hour===12){this.hour--;return this.toggleMeridian()}else{if(this.hour===0){this.hour=11;return this.toggleMeridian()}else{this.hour--}}}}else{if(this.hour<=0){this.hour=23}else{this.hour--}}},decrementMinute:function(g){var f;if(g){f=this.minute-g}else{f=this.minute-this.minuteStep}if(f<0){this.decrementHour();this.minute=f+60}else{this.minute=f}},decrementSecond:function(){var f=this.second-this.secondStep;if(f<0){this.decrementMinute(true);this.second=f+60}else{this.second=f}},elementKeydown:function(f){switch(f.keyCode){case 9:case 27:this.updateFromElementVal();break;case 37:f.preventDefault();this.highlightPrevUnit();break;case 38:f.preventDefault();switch(this.highlightedUnit){case"hour":this.incrementHour();this.highlightHour();break;case"minute":this.incrementMinute();this.highlightMinute();break;case"second":this.incrementSecond();this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break}this.update();break;case 39:f.preventDefault();this.highlightNextUnit();break;case 40:f.preventDefault();switch(this.highlightedUnit){case"hour":this.decrementHour();this.highlightHour();break;case"minute":this.decrementMinute();this.highlightMinute();break;case"second":this.decrementSecond();this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break}this.update();break}},getCursorPosition:function(){var g=this.$element.get(0);if("selectionStart" in g){return g.selectionStart}else{if(a.selection){g.focus();var h=a.selection.createRange(),f=a.selection.createRange().text.length;h.moveStart("character",-g.value.length);return h.text.length-f}}},getTemplate:function(){var h,j,g,f,i,k;if(this.showInputs){j='<input type="text" class="bootstrap-timepicker-hour form-control" maxlength="2"/>';g='<input type="text" class="bootstrap-timepicker-minute form-control" maxlength="2"/>';f='<input type="text" class="bootstrap-timepicker-second form-control" maxlength="2"/>';i='<input type="text" class="bootstrap-timepicker-meridian form-control" maxlength="2"/>'}else{j='<span class="bootstrap-timepicker-hour"></span>';g='<span class="bootstrap-timepicker-minute"></span>';f='<span class="bootstrap-timepicker-second"></span>';i='<span class="bootstrap-timepicker-meridian"></span>'}k='<table><tr><td><a href="#" data-action="incrementHour"><i class="glyphicon glyphicon-chevron-up"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="glyphicon glyphicon-chevron-up"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="glyphicon glyphicon-chevron-up"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="glyphicon glyphicon-chevron-up"></i></a></td>':"")+"</tr><tr><td>"+j+'</td> <td class="separator">:</td><td>'+g+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+f+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+i+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="glyphicon glyphicon-chevron-down"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="glyphicon glyphicon-chevron-down"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="glyphicon glyphicon-chevron-down"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="glyphicon glyphicon-chevron-down"></i></a></td>':"")+"</tr></table>";switch(this.template){case"modal":h='<div class="bootstrap-timepicker-widget modal hide fade in" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">×</a><h3>Pick a Time</h3></div><div class="modal-content">'+k+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">OK</a></div></div>';break;case"dropdown":h='<div class="bootstrap-timepicker-widget dropdown-menu">'+k+"</div>";break}return h},getTime:function(){if(this.hour===""){return""}return this.hour+":"+(this.minute.toString().length===1?"0"+this.minute:this.minute)+(this.showSeconds?":"+(this.second.toString().length===1?"0"+this.second:this.second):"")+(this.showMeridian?" "+this.meridian:"")},hideWidget:function(){if(this.isOpen===false){return}this.$element.trigger({type:"hide.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});if(this.template==="modal"&&this.$widget.modal){this.$widget.modal("hide")}else{this.$widget.removeClass("open")}d(a).off("mousedown.timepicker, touchend.timepicker");this.isOpen=false;this.$widget.detach()},highlightUnit:function(){this.position=this.getCursorPosition();if(this.position>=0&&this.position<=2){this.highlightHour()}else{if(this.position>=3&&this.position<=5){this.highlightMinute()}else{if(this.position>=6&&this.position<=8){if(this.showSeconds){this.highlightSecond()}else{this.highlightMeridian()}}else{if(this.position>=9&&this.position<=11){this.highlightMeridian()}}}}},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":if(this.showSeconds){this.highlightSecond()}else{if(this.showMeridian){this.highlightMeridian()}else{this.highlightHour()}}break;case"second":if(this.showMeridian){this.highlightMeridian()}else{this.highlightHour()}break;case"meridian":this.highlightHour();break}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":if(this.showMeridian){this.highlightMeridian()}else{if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}}break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":if(this.showSeconds){this.highlightSecond()}else{this.highlightMinute()}break}},highlightHour:function(){var f=this.$element.get(0),g=this;this.highlightedUnit="hour";if(f.setSelectionRange){setTimeout(function(){if(g.hour<10){f.setSelectionRange(0,1)}else{f.setSelectionRange(0,2)}},0)}},highlightMinute:function(){var f=this.$element.get(0),g=this;this.highlightedUnit="minute";if(f.setSelectionRange){setTimeout(function(){if(g.hour<10){f.setSelectionRange(2,4)}else{f.setSelectionRange(3,5)}},0)}},highlightSecond:function(){var f=this.$element.get(0),g=this;this.highlightedUnit="second";if(f.setSelectionRange){setTimeout(function(){if(g.hour<10){f.setSelectionRange(5,7)}else{f.setSelectionRange(6,8)}},0)}},highlightMeridian:function(){var f=this.$element.get(0),g=this;this.highlightedUnit="meridian";if(f.setSelectionRange){if(this.showSeconds){setTimeout(function(){if(g.hour<10){f.setSelectionRange(8,10)}else{f.setSelectionRange(9,11)}},0)}else{setTimeout(function(){if(g.hour<10){f.setSelectionRange(5,7)}else{f.setSelectionRange(6,8)}},0)}}},incrementHour:function(){if(this.showMeridian){if(this.hour===11){this.hour++;return this.toggleMeridian()}else{if(this.hour===12){this.hour=0}}}if(this.hour===23){this.hour=0;return}this.hour++},incrementMinute:function(g){var f;if(g){f=this.minute+g}else{f=this.minute+this.minuteStep-(this.minute%this.minuteStep)}if(f>59){this.incrementHour();this.minute=f-60}else{this.minute=f}},incrementSecond:function(){var f=this.second+this.secondStep-(this.second%this.secondStep);if(f>59){this.incrementMinute(true);this.second=f-60}else{this.second=f}},mousewheel:function(g){if(this.disableMousewheel){return}g.preventDefault();g.stopPropagation();var h=g.originalEvent.wheelDelta||-g.originalEvent.detail,f=null;if(g.type==="mousewheel"){f=(g.originalEvent.wheelDelta*-1)}else{if(g.type==="DOMMouseScroll"){f=40*g.originalEvent.detail}}if(f){g.preventDefault();d(this).scrollTop(f+d(this).scrollTop())}switch(this.highlightedUnit){case"minute":if(h>0){this.incrementMinute()}else{this.decrementMinute()}this.highlightMinute();break;case"second":if(h>0){this.incrementSecond()}else{this.decrementSecond()}this.highlightSecond();break;case"meridian":this.toggleMeridian();this.highlightMeridian();break;default:if(h>0){this.incrementHour()}else{this.decrementHour()}this.highlightHour();break}return false},place:function(){if(this.isInline){return}var h=this.$widget.outerWidth(),o=this.$widget.outerHeight(),j=10,l=d(c).width(),g=d(c).height(),k=d(c).scrollTop();var r=parseInt(this.$element.parents().filter(function(){}).first().css("z-index"),10)+10;var n=this.component?this.component.parent().offset():this.$element.offset();var s=this.component?this.component.outerHeight(true):this.$element.outerHeight(false);var i=this.component?this.component.outerWidth(true):this.$element.outerWidth(false);var m=n.left,q=n.top;this.$widget.removeClass("timepicker-orient-top timepicker-orient-bottom timepicker-orient-right timepicker-orient-left");if(this.orientation.x!=="auto"){this.picker.addClass("datepicker-orient-"+this.orientation.x);if(this.orientation.x==="right"){m-=h-i}}else{this.$widget.addClass("timepicker-orient-left");if(n.left<0){m-=n.left-j}else{if(n.left+h>l){m=l-h-j}}}var f=this.orientation.y,p,t;if(f==="auto"){p=-k+n.top-o;t=k+g-(n.top+s+o);if(Math.max(p,t)===t){f="top"}else{f="bottom"}}this.$widget.addClass("timepicker-orient-"+f);if(f==="top"){q+=s}else{q-=o+parseInt(this.$widget.css("padding-top"),10)}this.$widget.css({top:q,left:m,zIndex:r})},remove:function(){d("document").off(".timepicker");if(this.$widget){this.$widget.remove()}delete this.$element.data().timepicker},setDefaultTime:function(h){if(!this.$element.val()){if(h==="current"){var f=new Date(),g=f.getHours(),j=f.getMinutes(),k=f.getSeconds(),i="AM";if(k!==0){k=Math.ceil(f.getSeconds()/this.secondStep)*this.secondStep;if(k===60){j+=1;k=0}}if(j!==0){j=Math.ceil(f.getMinutes()/this.minuteStep)*this.minuteStep;if(j===60){g+=1;j=0}}if(this.showMeridian){if(g===0){g=12}else{if(g>=12){if(g>12){g=g-12}i="PM"}else{i="AM"}}}this.hour=g;this.minute=j;this.second=k;this.meridian=i;this.update()}else{if(h===false){this.hour=0;this.minute=0;this.second=0;this.meridian="AM"}else{this.setTime(h)}}}else{this.updateFromElementVal()}},setTime:function(k,i){if(!k){this.clear();return}var j,f,l,g,h;if(typeof k==="object"&&k.getMonth){f=k.getHours();l=k.getMinutes();g=k.getSeconds();if(this.showMeridian){h="AM";if(f>12){h="PM";f=f%12}if(f===12){h="PM"}}}else{if(k.match(/p/i)!==null){h="PM"}else{h="AM"}k=k.replace(/[^0-9\:]/g,"");j=k.split(":");f=j[0]?j[0].toString():j.toString();l=j[1]?j[1].toString():"";g=j[2]?j[2].toString():"";if(f.length>4){g=f.substr(4,2)}if(f.length>2){l=f.substr(2,2);f=f.substr(0,2)}if(l.length>2){g=l.substr(2,2);l=l.substr(0,2)}if(g.length>2){g=g.substr(2,2)}f=parseInt(f,10);l=parseInt(l,10);g=parseInt(g,10);if(isNaN(f)){f=0}if(isNaN(l)){l=0}if(isNaN(g)){g=0}if(this.showMeridian){if(f<1){f=1}else{if(f>12){f=12}}}else{if(f>=24){f=23}else{if(f<0){f=0}}if(f<13&&h==="PM"){f=f+12}}if(l<0){l=0}else{if(l>=60){l=59}}if(this.showSeconds){if(isNaN(g)){g=0}else{if(g<0){g=0}else{if(g>=60){g=59}}}}}this.hour=f;this.minute=l;this.second=g;this.meridian=h;this.update(i)},showWidget:function(){if(this.isOpen){return}if(this.$element.is(":disabled")){return}this.$widget.appendTo(this.appendWidgetTo);var f=this;d(a).on("mousedown.timepicker, touchend.timepicker",function(g){if(!(f.$element.parent().find(g.target).length||f.$widget.is(g.target)||f.$widget.find(g.target).length)){f.hideWidget()}});this.$element.trigger({type:"show.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}});this.place();if(this.disableFocus){this.$element.blur()}if(this.hour===""){if(this.defaultTime){this.setDefaultTime(this.defaultTime)}else{this.setTime("0:0:0")}}if(this.template==="modal"&&this.$widget.modal){this.$widget.modal("show").on("hidden",d.proxy(this.hideWidget,this))}else{if(this.isOpen===false){this.$widget.addClass("open")}}this.isOpen=true},toggleMeridian:function(){this.meridian=this.meridian==="AM"?"PM":"AM"},update:function(f){this.updateElement();if(!f){this.updateWidget()}this.$element.trigger({type:"changeTime.timepicker",time:{value:this.getTime(),hours:this.hour,minutes:this.minute,seconds:this.second,meridian:this.meridian}})},updateElement:function(){this.$element.val(this.getTime()).change()},updateFromElementVal:function(){this.setTime(this.$element.val())},updateWidget:function(){if(this.$widget===false){return}var f=this.hour,h=this.minute.toString().length===1?"0"+this.minute:this.minute,g=this.second.toString().length===1?"0"+this.second:this.second;if(this.showInputs){this.$widget.find("input.bootstrap-timepicker-hour").val(f);this.$widget.find("input.bootstrap-timepicker-minute").val(h);if(this.showSeconds){this.$widget.find("input.bootstrap-timepicker-second").val(g)}if(this.showMeridian){this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)}}else{this.$widget.find("span.bootstrap-timepicker-hour").text(f);this.$widget.find("span.bootstrap-timepicker-minute").text(h);if(this.showSeconds){this.$widget.find("span.bootstrap-timepicker-second").text(g)}if(this.showMeridian){this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian)}}},updateFromWidgetInputs:function(){if(this.$widget===false){return}var f=this.$widget.find("input.bootstrap-timepicker-hour").val()+":"+this.$widget.find("input.bootstrap-timepicker-minute").val()+(this.showSeconds?":"+this.$widget.find("input.bootstrap-timepicker-second").val():"")+(this.showMeridian?this.$widget.find("input.bootstrap-timepicker-meridian").val():"");this.setTime(f,true)},widgetClick:function(g){g.stopPropagation();g.preventDefault();var h=d(g.target),f=h.closest("a").data("action");if(f){this[f]()}this.update();if(h.is("input")){h.get(0).setSelectionRange(0,2)}},widgetKeydown:function(g){var h=d(g.target),f=h.attr("class").replace("bootstrap-timepicker-","");switch(g.keyCode){case 9:if((this.showMeridian&&f==="meridian")||(this.showSeconds&&f==="second")||(!this.showMeridian&&!this.showSeconds&&f==="minute")){return this.hideWidget()}break;case 27:this.hideWidget();break;case 38:g.preventDefault();switch(f){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian();break}this.setTime(this.getTime());h.get(0).setSelectionRange(0,2);break;case 40:g.preventDefault();switch(f){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian();break}this.setTime(this.getTime());h.get(0).setSelectionRange(0,2);break}},widgetKeyup:function(f){if((f.keyCode===65)||(f.keyCode===77)||(f.keyCode===80)||(f.keyCode===46)||(f.keyCode===8)||(f.keyCode>=46&&f.keyCode<=57)){this.updateFromWidgetInputs()}}};d.fn.timepicker=function(g){var f=Array.apply(null,arguments);f.shift();return this.each(function(){var j=d(this),i=j.data("timepicker"),h=typeof g==="object"&&g;if(!i){j.data("timepicker",(i=new b(this,d.extend({},d.fn.timepicker.defaults,h,d(this).data()))))}if(typeof g==="string"){i[g].apply(i,f)}})};d.fn.timepicker.defaults={defaultTime:"current",disableFocus:false,disableMousewheel:false,isOpen:false,minuteStep:15,modalBackdrop:false,orientation:{x:"auto",y:"auto"},secondStep:15,showSeconds:false,showInputs:true,showMeridian:true,template:"dropdown",appendWidgetTo:"body",showWidgetOnAddonClick:true};d.fn.timepicker.Constructor=b})(jQuery,window,document);"use strict";var GtdHeading,HeadingManager;GtdHeading=function(b){var c,d,a;if(!b){b={}}this.fields={archived:false,priority:"B",scope:[],text:"",title:"",todo_state:null,tree_id:null,};this.pk=0;this.archived=false;this.populated=false;this.expandable="lazy";this.rank=1;this.state="closed";this.visible=false;this.children=new HeadingManager(b.workspace);this.set_fields(b);this.parent_obj=this.get_parent();if(this.workspace){if(this.parent_obj){this.rank=this.parent_obj.rank+1}}};GtdHeading.prototype.set_fields=function(f){var g,h,e,c,b;b=$.extend({},f);e=/^\d{4}-\d{2}-\d{2}[0-9:TZ]*/;if(b.id!==undefined){this.pk=Number(b.id);delete b.id}if(b.workspace!==undefined){this.workspace=b.workspace;delete b.workspace}this.model=b.model;delete b.model;try{if(b.parent===this.pk){throw"bad parent"}}catch(a){if(a==="bad parent"){console.error("Cannot create node as a child of itself");throw a}}jQuery.extend(this.fields,b)};GtdHeading.prototype.get_todo_state=function(){var d,b,c,a;d=null;if(typeof this.workspace!=="undefined"){for(b=0;b<this.workspace.todo_states.length;b+=1){c=this.workspace.todo_states[b];if(c.pk===Number(this.todo_state)){d=c}}}if(d){a=d}else{a={pk:this.todo_state}}return a};GtdHeading.prototype.get_title=function(){var a;a=this.title;if(this.archived){a='<span class="archived-text">'+a+"</span>"}return a};GtdHeading.prototype.get_previous_sibling=function(){var b,c,a;b=null;if(this.level===0){c=this.fields.tree_id;while(c>1&&b===null){c=c-1;b=this.workspace.headings.get({tree_id:c,level:0,})}}else{a=this.fields.lft;a=a-2;while(a>1&&b===null){b=this.workspace.headings.get({tree_id:this.fields.tree_id,parent:this.fields.parent,lft:a,})}}return b};GtdHeading.prototype.get_parent=function(){var a;if(this.rank>0&&this.workspace){if(this.fields.parent===null){a=this.workspace}else{a=this.workspace.headings.get({pk:this.fields.parent})}}else{a=null}return a};GtdHeading.prototype.get_children=function(){var a;if(this.rank===0){a=this.workspace.headings.filter_by({rank:1})}else{a=this.workspace.headings.filter_by({parent:this.pk}).order_by("lft")}return a};GtdHeading.prototype.refresh_tree=function(){var a,b,c,d;a="/gtd/tree/"+this.fields.tree_id+"/";c=this;$.get(a,function(e){while(typeof e==="string"){e=$.parseJSON(e)}for(b=0;b<e.length;b+=1){d=new GtdHeading(e[b]);c.workspace.headings.add(d)}})};GtdHeading.prototype.is_leaf_node=function(){var a;if(this.fields.rght-this.fields.lft===1){a=true}else{if(this.fields.rght-this.fields.lft>1){a=false}else{a=undefined}}return a};GtdHeading.prototype.is_expandable=function(){var b,c,a;b=false;if(this.rank===0){b=true}if(this.text){b=true}else{if(this.workspace.show_all){if(this.workspace.active_scope){b=this.get_children().filter_by({scope:this.workspace.active_scope}).length}else{b=!this.is_leaf_node()}}else{c=this.get_children();if(this.workspace.active_scope){c=c.filter_by({scope:this.workspace.active_scope})}if(c.filter_by({archived:false}).length){b=true}else{if(this.populated===false&&!this.is_leaf_node()){b=true}}}}if(b){a=true}else{a=false}return a};GtdHeading.prototype.is_visible=function(i){var b,e,j,c,f,d,k,g,h,a;b=true;this.update();if(this.workspace.active_scope){if(this.fields.scope.indexOf(this.workspace.active_scope)===-1){b=false}}j=this.workspace.active_states;if(typeof j!=="undefined"){f=true;if(j.indexOf(this.fields.todo_state)===-1){f=false}d=this.just_modified||false;k=this.todo_state?this.todo_state.fields.closed:false;if(this.fields.deadline_date&&!k){g=7;h=g*24*60*60*1000;a=(this.due()<h)}else{a=false}if(!f&&!a&&!d){b=false}}e=this.workspace?this.workspace.show_arx:false;if(this.fields.archived&&!e){b=false}c=this.workspace.active_root;if(c){if(c.fields.tree_id!==this.fields.tree_id){b=false}}if(this.parent_obj&&!this.workspace.show_list){if(this.parent_obj.state!=="open"){b=false}}if(this.pk===15){console.log(this.parent_obj)}if(this.pk===-1){b=false}return b};GtdHeading.prototype.due=function(){var c,a,b;c=null;if(this.fields.deadline_date){a=new Date();b=new Date(this.fields.deadline_date);c=b-a}return c};GtdHeading.prototype.update=function(){var a;a=/\S+/;if(a.test(this.fields.text)){this.expandable="yes"}else{if(this.populated){if(this.children.length>0){this.expandable="yes"}else{this.expandable="no"}}}this.todo_state=this.workspace.todo_states.get({pk:this.fields.todo_state});this.children=this.workspace.headings.filter_by({parent:this.pk});this.parent_obj=this.get_parent()};GtdHeading.prototype.save=function(b){var a,f,d,c,e;e=this;if(b===undefined){b={}}c=b.auto?true:false;a="/gtd/node/";e.fields.auto_update=c;d=jQuery.extend({},e.fields,{id:e.pk});if(e.pk>0){a+=e.pk+"/";f="PUT"}else{f="POST"}jQuery.ajax(a,{type:f,data:JSON.stringify(d),contentType:"application/json",success:function(i,g,h){e.workspace.$apply(function(){var j;if(typeof i==="string"){i=jQuery.parseJSON(i)}e.pk=i.pk;e.set_fields(i);e.update()})},error:function(i,g,h){alert("Not saved");console.error(i.responseText)},})};GtdHeading.prototype.move_to=function(h,d){var g,c,b,a,f,e;g=this;b=true;if(d===undefined){d={}}if(d.position===undefined){d.position="first-child"}if(d.save===undefined){d.save=false}a=function(){var i=true;if(g.fields.tree_id===h.fields.tree_id){if(g===h){console.error("GtdHeading refusing to move relative to itself");i=false}else{if(h.fields.lft>g.fields.lft&&h.fields.rght<g.fields.rght){console.error("GtdHeading refusing to move relative to its own child");i=false}}}return i};f=function(){var i=a();if(i===true){g.fields.parent=h.pk;g.fields.tree_id=h.fields.tree_id;g.level=h.level+1;g.rank=h.rank+1}return i};e=function(){var i=a();if(i===true){g.fields.parent=h.fields.parent;g.fields.tree_id=h.fields.tree_id;g.level=h.level;g.rank=h.rank}return i};c={"first-child":function(){var i=f();if(i===true){g.fields.lft=-1}return i},"last-child":function(){var j,i;j=f();if(j===true){i=h.get_children();g.fields.lft=i[i.length-1].fields.lft+1}return j},left:function(){var i=e();if(i===true){g.fields.lft=h.fields.lft-1}return i},right:function(){var i=e();if(i===true){g.fields.lft=h.fields.lft+1}return i}};if(typeof c[d.position]==="function"){b=c[d.position]()}else{b=false}if(b===true){h.update();g.rebuild()}return b};GtdHeading.prototype.rebuild=function(){var a,b;a=this.workspace.headings.get({tree_id:this.fields.tree_id,rank:1});b=function(f,g){var e,c,d;f.fields.lft=g;e=f.get_children();c=g+1;for(d=0;d<e.length;d+=1){c=b(e[d],c)+1}f.fields.rght=c;return c};if(a.fields.lft===undefined){a.fields.lft=1}b(a,a.fields.lft)};GtdHeading.prototype.has_scope=function(b){var a;if(b===0){a=true}else{if((b===-1)&&(this.scope.length===0)){a=true}else{if(jQuery.inArray(b,this.scope)>-1){a=true}else{a=false}}}return a};GtdHeading.prototype.set_indent=function(b,c){var a=(this.icon_width+4)*c;b.css("margin-left",a+"px")};GtdHeading.prototype.populate_children=function(b){var a,c,d;if(typeof b==="undefined"){b={}}a="/gtd/node/";c=this;d=function(e){var f,g;g=c.fields.level+e.offset;f={level:g,tree_id:c.fields.tree_id,rght__lt:c.fields.rght,lft__gt:c.fields.lft,};$.getJSON(a,f,function(i,h,j){c.workspace.$apply(function(){var k,l,n,o,m;if(h==="success"){k=i;for(l=0;l<k.length;l+=1){n=k[l];n.workspace=c.workspace;o=new GtdHeading(n);m=o.get_parent();if(m||o.rank===1){o=c.workspace.headings.add(o)}if(m){m.children.add(o);if(m.state==="open"){o.visible=true}}}if(c.rank===0){c.populated=true}if(e.offset===1){c.populated=true;c.update()}else{if(e.offset===2){for(l=0;l<c.children.length;l+=1){c.children[l].populated=true;c.children[l].update()}}}if(e.callback){e.callback()}}})})};if(!this.populated){if(this.rank>0&&this.$children){this.$children.hide()}d({offset:1,callback:function(){if(!c.populated_level_2){d({offset:2});c.populated_level_2=true}}})}else{if(!this.populated_level_2){d({offset:2});this.populated_level_2=true}}};GtdHeading.prototype.toggle=function(a){this.populate_children();if(typeof a!=="undefined"){this.state=a}else{if(this.state==="open"){this.state="closed"}else{if(this.state==="closed"){this.state="open"}}}};var HeadingManager=function(a){var b=[];b.workspace=a;return b};Array.prototype.get=function(c){var b,a;a=this.filter_by(c);if(a.length===1){b=a[0]}else{if(a.length>1){console.error("HeadingManager.get():query did not produce unique result. Returning first result");console.log(c);console.log(a);b=a[0]}else{b=null}}return b};Array.prototype.filter_by=function(g){var a,c,e,f,b,d;a=[];a.workspace=this.workspace;for(c=0;c<this.length;c+=1){e=this[c];if(e.rank===0){f=false}else{f=true}for(b in g){if(g.hasOwnProperty(b)){if(typeof e.fields!=="undefined"){if(Object.keys(e.fields).indexOf(b)>-1){d=e.fields}else{d=e}}else{d=e}if(d[b] instanceof Array){if(g[b] instanceof Array){if(!(($(e.scope).not([]).length===0&&$([]).not(e.scope).length===0)&&typeof e.scope!=="undefined")){f=false}}else{if(jQuery.inArray(g[b],d[b])<0){f=false}}}else{if(d[b]!==g[b]){f=false}}}}if(f){a.push(e)}}return a};Array.prototype.order_by=function(e){var a,b,d,c;a=/^(-)?(\S*)$/.exec(e);c=a[2];b=this.slice(0);d=function(g,f){var l,i,k,j,h;if(g.fields.hasOwnProperty(c)&&f.fields.hasOwnProperty(c)){l=g.fields[c];i=f.fields[c]}else{l=g[c];i=f[c]}k=Number(l);j=Number(i);if(k&&j){h=k-j}else{l=l.toUpperCase();i=i.toUpperCase();if(l<i){h=-1}else{if(l>i){h=1}else{h=0}}}return h};b.sort(d);if(a[1]==="-"){b.reverse()}return b};Array.prototype.add=function(g){var d,f,c,a,e,h,b;d=this;c=["pk","populated","text","todo_state","archived","rank","scope","parent"];e=function(k){var i,j;i=[];j=function(m){var l;f=d.get({pk:m.pk});if(f){m.populated=f.populated;for(l in m.fields){if(m.fields.hasOwnProperty(l)){f.fields[l]=m.fields[l]}}a=f}else{m.workspace=d.workspace;d.push(m);a=m}a.update();i.push(a.get_parent());return a};if(k instanceof Array){for(b=0;b<k.length;b+=1){h=new GtdHeading(k[b]);j(h)}}else{a=j(k)}i=i.filter(function(n,m,l){return l.lastIndexOf(n)===m});for(b=0;b<i.length;b+=1){if(i[b]){i[b].update()}}};if(g.$resolved===false){g.$promise.then(e)}else{e(g)}return a};Array.prototype.remove=function(c){var a,b;b=false;a=this.indexOf(c);if(a>-1){this.splice(a,1);b=true}return b};Date.prototype.ow_date=function(){var a;a=this.getFullYear()+"-"+(this.getMonth()+1)+"-"+this.getDate();return a};"use strict";var test_headings,owConfig,HeadingFactory,GtdListFactory,UpcomingFactory,outlineCtrl,listCtrl;var gtd_module=angular.module("orgWolf",["ngAnimate","ngResource","ngSanitize"]);gtd_module.config(["$httpProvider","$locationProvider",owConfig]);function owConfig(d,b){d.defaults.headers.common["X-Request-With"]="XMLHttpRequest";function a(e){var j,h,g,f;j=null;if(document.cookie&&document.cookie!==""){h=document.cookie.split(";");for(g=0;g<h.length;g+=1){f=jQuery.trim(h[g]);if(f.substring(0,e.length+1)===(e+"=")){j=decodeURIComponent(f.substring(e.length+1));break}}}return j}var c=a("csrftoken");$.ajaxSetup({beforeSend:function(e){e.setRequestHeader("X-CSRFToken",c)}})}gtd_module.factory("OldHeading",["$resource","$http",function(a,b){return function(c){return new GtdHeading(c)}}]);gtd_module.factory("Heading",["$resource","$http",HeadingFactory]);function HeadingFactory(b,c){var a=b("/gtd/node/:pk/",{pk:"@pk"},{query:{method:"GET",transformResponse:c.defaults.transformResponse.concat([function(e,d){return e}]),isArray:true},});return a}gtd_module.factory("Upcoming",["$resource","$http",UpcomingFactory]);function UpcomingFactory(b,c){var a=b("/gtd/node/upcoming/",{},{query:{method:"GET",transformResponse:c.defaults.transformResponse.concat([function(e,d){return e}]),isArray:true},});return a}gtd_module.factory("GtdList",["$resource","$http",GtdListFactory]);function GtdListFactory(b,c){var a=b("/gtd/lists/",{},{query:{method:"GET",transformResponse:c.defaults.transformResponse.concat([function(f,e){var d,g;for(d=0;d<f.length;d+=1){g=new GtdHeading(f[d]);jQuery.extend(f[d],g)}return f}]),isArray:true},});return a}gtd_module.filter("style",function(){return function(e){var d,f,a,b;d="";if(e===null||e===undefined){d=null}else{if(e.model==="gtd.todostate"){f={};f.RED_OFFSET=16;f.GREEN_OFFSET=8;f.BLUE_OFFSET=0;f.RED_MASK=16711680;f.GREEN_MASK=65280;f.BLUE_MASK=255;f.red=(e.fields._color_rgb&f.RED_MASK)>>f.RED_OFFSET;f.green=(e.fields._color_rgb&f.GREEN_MASK)>>f.GREEN_OFFSET;f.blue=(e.fields._color_rgb&f.BLUE_MASK)>>f.BLUE_OFFSET;d+="color: rgba("+f.red+", "+f.green+", "+f.blue;d+=", "+e.fields._color_alpha+"); ";if(e.fields.actionable){d+="font-weight: bold; "}}else{a=["rgb(88, 0, 176)","rgb(80, 0, 0)","rgb(0, 44, 19)","teal","slateblue","brown"];b=(e.fields.level)%a.length;d+="color: "+a[b]+"; "}}return d}});gtd_module.filter("asHtml",["$sce",function(a){return function(c){var b=a.trustAsHtml(c);return b}}]);gtd_module.filter("order",["$sce",function(a){return function(f,e){var c,d,b;if(e==="list"){b=f.filter_by({deadline_date:null});d=$(f).not(b).get().order_by("deadline_date");c=d;c=c.concat(b.order_by("priority"))}else{c=f.order_by(e)}return c}}]);gtd_module.filter("root_cell",["$sce",function(a){return function(d){var c,b;b="";c=d.workspace.parents.get({tree_id:d.fields.tree_id,level:0});if(c){b+="<a>";b+=c.fields.title+"</a>"}b=a.trustAsHtml(b);return b}}]);gtd_module.filter("deadline_str",["$sce",function(a){return function(e){var f,c,b,d,g;f="";if(e.fields.deadline_date){f="Due ";c=new Date(e.fields.deadline_date+"T12:00:00");b=new Date();b.setHours(12,0,0,0);d=c.getTime()-b.getTime();g=Math.ceil(d/(1000*3600*24));if(g===0){f+="today"}else{if(g===-1){f+="yesterday"}else{if(g<0){f+=Math.abs(g)+" days ago"}else{if(g===1){f+="tomorrow"}else{if(g>0){f+="in "+g+" days"}}}}}}return f}}]);gtd_module.directive("owEditable",function(){function a(f,d,c){var e,g,b;f.fields=jQuery.extend(true,{},f.heading.fields);f.priorities=[{sym:"A",display:"A - high"},{sym:"B",display:"B - medium (default)"},{sym:"C",display:"C - low"}];f.time_units=[{value:"d",label:"Days"},{value:"w",label:"Weeks"},{value:"m",label:"Months"},{value:"y",label:"Years"},];f.repeat_schemes=[{value:false,label:"scheduled date"},{value:true,label:"completion date"},];e=d.find(".edit-text");b=d.find("#edit-save");$("body").animate({scrollTop:d.offset().top-27},"500");d.find(".make-switch").each(function(){var h;h=$(this).find("input").attr("ng-model").split(".")[1];$(this).bootstrapSwitch();$(this).bootstrapSwitch("setState",f.fields[h])});d.find(".make-switch").on("switch-change",function(j,h){var i;i=$(j.target).find("input").attr("ng-model").split(".")[1];f.fields[i]=h.value});d.find(".datepicker").datepicker({format:"yyyy-mm-dd",});d.find(".timepicker").timepicker({showMeridian:false,showSeconds:true,});d.find(".timepicker,.datepicker").on("change",function(j){var h,i;h=$(j.target);i=h.attr("ng-model").split(".")[1];f.fields[i]=h.val()});d.find("#title").focus();f.save=function(h){f.fields.text=d.find(".edit-text")[0].innerHTML;f.heading.fields=f.fields;f.heading.update();f.heading.editable=false;f.heading.save()};f.cancel_edit=function(h){f.heading.editable=false;if(f.heading.pk===0){f.heading.pk=-1}};Aloha.ready(function(){Aloha.jQuery(d.find(".edit-text")).aloha()})}return{link:a}});gtd_module.directive("owScopeTabs",["$resource",function(a){function b(f,e,d){var c;c=a("/gtd/scope/");f.scopes=c.query();e.addClass("nav").addClass("nav-tabs");e.find('[scope_id="'+f.active_scope+'"]').addClass("active");f.change_scope=function(h){var g;e.find('[scope_id="'+f.active_scope+'"]').removeClass("active");f.active_scope=parseInt($(h.currentTarget).attr("scope_id"),10);e.find('[scope_id="'+f.active_scope+'"]').addClass("active")}}return{link:b}}]);gtd_module.directive("owTodo",["$filter",function(b){function a(o,g,n){var h,m,f,j,d,l,p,c;c=b("style");o.heading.todo_popover=false;m=g.children("span");if(o.heading.todo_state){m.tooltip({delay:{show:1000,hide:100},title:o.heading.todo_state.fields.display_text,placement:"right"})}function e(i){g.popover("destroy")}function k(i){$("body").append('<div id="todo-popover"></div>');l='<div class="todo-option" todo_id=""';if(o.heading.fields.todo_state===null){l+=" selected"}l+=">[None]</div>\n";for(h=0;h<o.todo_states.length;h+=1){d=o.todo_states[h];p='<div class="todo-option" todo_id="'+d.pk+'"';p+='style="'+c(d)+'"';if(d.pk===o.heading.fields.todo_state){p+=" selected"}p+=">"+d.fields.abbreviation+"</div>\n";l+=p}i.popover({title:"Todo State",content:l,html:true,container:"#todo-popover"});i.popover("show");$("body").on("click.todo_state",function(q){if(!$(q.target).hasClass("todo-state")){i.popover("destroy")}});j=$(".todo-option").not("[selected]");j.on("click.todostate",function(q){o.$apply(function(){var r=$(q.target).attr("todo_id");if(r===""){o.heading.fields.todo_state=null}else{o.heading.fields.todo_state=parseInt(r,10)}o.heading.update();o.heading.just_modified=true;o.heading.save({auto:true});e(i)})})}m.on("click",function(i){k(m)})}return{link:a,templateUrl:"todo-state-selector",}}]);gtd_module.directive("owListRow",function(){function a(j,c,i){var e,k,h,b,d,f,g;e=parseInt(i.owPk,10);k=j.headings.get({pk:e});f=k.due();if(f===null){g=""}else{if(f<=0){g="danger"}else{if(f>0){g="warning"}}}c.addClass(g)}return{link:a,}});gtd_module.controller("nodeOutline",["$scope","$http","$resource","OldHeading","Heading","$element","$location","$anchorScroll",outlineCtrl]);function outlineCtrl(n,q,h,i,o,l,f,d){var j,e,c,m,g,p,a,b,k,r;r=o.query({parent_id:0,archived:false});n.headings=new HeadingManager(n);n.children=new HeadingManager(n);n.headings.add(r);n.headings.add(r);n.active_scope=0;n.sort_field="title";n.sort_fields=[{key:"title",display:"Title"},{key:"-title",display:"Title (reverse)"},];n.parent_id=l.attr("parent_id");if(n.parent_id===""){n.parent_id=0}else{n.parent_id=parseInt(n.parent_id,10)}n.show_arx=false;n.state="open";n.rank=0;n.update=function(){n.children=n.headings.filter_by({parent:null})};j=h("/gtd/todostate/");n.todo_states=j.query();test_headings=n.todo_states;if(n.parent_id){a=parseInt(l.attr("parent_tree"),10);b=parseInt(l.attr("level"),10);k=o.query({tree_id:a,level__lte:b+1});n.headings.add(k);k.$promise.then(function(){var t,s;t=n.headings.get({pk:n.parent_id});s=function(v){var u;v.toggle("open");v.update();u=v.get_parent();if(u.rank!==0){s(u)}};if(t.fields.archived){n.show_arx=true}s(t);t.editable=true})}m=function(v){var s,u,t;s=$(v.delegateTarget).closest(".heading");t=Number(s.attr("node_id"));u=n.headings.get({pk:t});return u};n.toggle_node=function(v){var s,t,u,w;s=$(v.target);u=m(v);if(s.hasClass("edit-btn")){u.populate_children();u.editable=true}else{if(s.hasClass("todo-state")){console.log("todo-state clicked")}else{if(s.hasClass("archive-btn")){if(u.fields.archived){u.fields.archived=false}else{u.fields.archived=true}u.save()}else{if(s.hasClass("new-btn")){w=new i({id:0,workspace:u.workspace,title:"",parent:u.pk,level:u.fields.level+1,scope:u.fields.scope,});w.editable=true;w.expandable="no";u.children.add(w);n.headings.add(w);u.toggle("open")}else{u.toggle()}}}}};n.show_all=function(t){var s;if(n.show_arx===true){n.show_arx=false}else{n.show_arx=true}if(!n.arx_cached){s=o.query({parent_id:0,archived:true});n.headings.add(s);n.headings.add(s);n.arx_cached=true}};n.add_heading=function(s){var t;console.log(n.children.get({pk:0}));t=new i({id:0,workspace:n,title:"",parent:null,level:0,});t.editable=true;n.headings.add(t);n.children.add(t);console.log(n.children.get({pk:0}))}}gtd_module.controller("nextActionsList",["$sce","$scope","$resource","$location","GtdList","Heading","Upcoming","parent_id","context_id","context_name",listCtrl]);function listCtrl(k,o,q,e,b,j,n,h,a,c){var d,f,m,g;o.list_params={todo_state:2};o.active_context=null;console.log(e.absUrl());if(a!=="None"){o.active_context=parseInt(a,10);o.context_name=c;o.list_params.context=o.active_context}o.show_list=true;o.update=function(){};f=q("/gtd/todostate/");o.todo_states=f.query();o.parents=new HeadingManager(o);o.parents.add(j.query({level:0}));if(h){o.list_params.parent=parseInt(h,10)}g=new Date();o.scheduled=new HeadingManager(o);o.scheduled.add(b.query({scheduled_date__lte:g.ow_date(),todo_state:8}));console.log(o.scheduled);o.headings=new HeadingManager(o);o.cached_states=[2];o.active_states=[2];o.headings.add(b.query(o.list_params));o.headings.add(n.query());m=q("/gtd/context/");o.contexts=m.query();o.show_arx=true;o.active_scope=0;for(d;d<o.headings.length;d+=1){o.headings[d].parent=o.parents.get({pk:o.headings[d].fields.parent})}o.toggle_todo_state=function(u){var s,v,t,r;v=parseInt($(u.target).attr("ow-state"),10);s=o.active_states.indexOf(v);if(s>-1){o.active_states.splice(s,1)}else{o.active_states.push(v)}if(o.cached_states.indexOf(v)===-1){o.cached_states.push(v);o.list_params.todo_state=v;o.headings.add(b.query(o.list_params))}};function l(){var r,s,t;r="";for(s=0;s<o.active_states.length;s+=1){t=o.todo_states.get({pk:o.active_states[s]});r+=t.fields.abbreviation.toLowerCase();r+="/"}return r}function p(){var i;if(o.active_context){i="context"+o.active_context+"/"}else{i=""}return i}o.change_context=function(i){o.headings=new HeadingManager(o);o.list_params.context=o.active_context;o.list_params.todo_state=o.active_states;o.headings.add(b.query(o.list_params))};o.filter_parent=function(r){if(r===null){delete o.active_root}else{var i=o.parents.get({tree_id:r.fields.tree_id});o.active_root=i}}};"use strict";$(document).ready(function(){var b,a;b=$(".login");b.before('<a href="#" class="persona-button"><span>Sign in with your Email</span></a>');a=b.prev("a.persona-button");if(b.hasClass("replace")){b.removeClass("row");b.html('<div><a href="/accounts/login/">Other login methods</a></div>');b.append('<div><a href="/accounts/register/">Other new user creation methods</a></div>')}a.bind("click.persona",function(c){navigator.id.request();$(this).attr("data-loading-text","Loading...")});$("#logout").bind("click.persona",function(c){console.log("logout");navigator.id.logout()});navigator.id.watch({loggedInUser:persona_user,onlogin:function(c){ow_waiting("spinner");console.log(c);$.ajax({type:"POST",url:"/accounts/login/persona/",data:{assertion:c},success:function(e,d,f){window.location.href=e.next},error:function(f,d,e){navigator.id.logout();alert("Login failure: "+e)}})},onlogout:function(){$.ajax({type:"POST",url:"/accounts/logout/persona/",success:function(d,c,e){},error:function(e,c,d){alert("Logout failure: "+d)}})}})});